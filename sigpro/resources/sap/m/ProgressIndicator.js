/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/ui/core/ValueStateSupport","sap/ui/core/library","./ProgressIndicatorRenderer","sap/base/Log"],function(e,t,a,r,i,s){"use strict";var u=r.TextDirection;var n=r.ValueState;var l=t.extend("sap.m.ProgressIndicator",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.m",properties:{enabled:{type:"boolean",group:"Behavior",defaultValue:true},state:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:n.None},displayValue:{type:"string",group:"Appearance",defaultValue:null},percentValue:{type:"float",group:"Data",defaultValue:0},showValue:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:u.Inherit},displayOnly:{type:"boolean",group:"Behavior",defaultValue:false}},designtime:"sap/m/designtime/ProgressIndicator.designtime"}});var o=sap.ui.getCore().getConfiguration().getAnimation();l.prototype.setPercentValue=function(e){var t=this,a,r,i=this.$(),u,n;e=this.validateProperty("percentValue",e);if(!p(e)){n=e;e=e>100?100:0;s.warning(this+": percentValue ("+n+") is not correct! Setting the percentValue to "+e)}if(this.getPercentValue()!==e){r=this.getPercentValue()-e;this.setProperty("percentValue",e,true);if(!i.length){return this}["sapMPIValueMax","sapMPIValueMin","sapMPIValueNormal","sapMPIValueGreaterHalf"].forEach(function(e){i.removeClass(e)});i.addClass(this._getCSSClassByPercentValue(e));i.addClass("sapMPIAnimate").attr("aria-valuenow",e).attr("aria-valuetext",this._getAriaValueText({fPercent:e}));u=o?Math.abs(r)*20:0;a=this.$("bar");a.stop();a.animate({"flex-basis":e+"%"},u,"linear",function(){t._setText.apply(t);t.$().removeClass("sapMPIAnimate")})}return this};l.prototype._setText=function(){this.$().toggleClass("sapMPIValueGreaterHalf",this.getPercentValue()>50);return this};l.prototype.setDisplayValue=function(e){this.setProperty("displayValue",e,true);var t=this.$("textLeft");var a=this.$("textRight");t.text(e);a.text(e);this.$().attr("aria-valuetext",this._getAriaValueText({sText:e}));return this};l.prototype.setDisplayOnly=function(e){this.setProperty("displayOnly",e,true);if(this.getDomRef()){this.$().toggleClass("sapMPIDisplayOnly",e)}return this};l.prototype._getCSSClassByPercentValue=function(e){if(e===100){return"sapMPIValueMax sapMPIValueGreaterHalf"}if(e===0){return"sapMPIValueMin"}if(e<=50){return"sapMPIValueNormal"}return"sapMPIValueNormal sapMPIValueGreaterHalf"};l.prototype._getAriaValueText=function(e){e.sText=e.sText||this.getDisplayValue();e.fPercent=e.fPercent||this.getPercentValue();e.sStateText=e.sStateText||this._getStateText();var t=e.sText||e.fPercent+"%";if(e.sStateText){t+=" "+e.sStateText}return t};l.prototype._getStateText=function(){return a.getAdditionalText(this.getState())};l.prototype.getAccessibilityInfo=function(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.m"),t=this.getDisplayValue(),a=t?t:e.getText("ACC_CTR_STATE_PROGRESS",[this.getPercentValue()]);return{role:"progressbar",type:e.getText("ACC_CTR_TYPE_PROGRESS"),description:a,focusable:this.getEnabled(),enabled:this.getEnabled()}};function p(e){return e>=0&&e<=100}return l});