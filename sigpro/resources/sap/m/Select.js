/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Dialog","./Popover","./SelectList","./library","sap/ui/core/Control","sap/ui/core/EnabledPropagator","sap/ui/core/Icon","sap/ui/core/IconPool","./Button","./Bar","./Title","./delegate/ValueStateMessage","sap/ui/core/message/MessageMixin","sap/ui/core/library","sap/ui/core/Item","sap/ui/Device","sap/ui/core/InvisibleText","./SelectRenderer","sap/ui/dom/containsOrEquals","sap/ui/events/KeyCodes"],function(e,t,i,s,o,r,n,a,l,p,c,u,h,g,d,f,y,m,S,I){"use strict";var v=s.SelectListKeyboardNavigationMode;var b=s.PlacementType;var C=g.ValueState;var _=g.TextDirection;var A=g.TextAlign;var T=s.SelectType;var P=o.extend("sap.m.Select",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.m.IOverflowToolbarContent"],library:"sap.m",properties:{name:{type:"string",group:"Misc",defaultValue:""},enabled:{type:"boolean",group:"Behavior",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"auto"},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},selectedKey:{type:"string",group:"Data",defaultValue:""},selectedItemId:{type:"string",group:"Misc",defaultValue:""},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:""},type:{type:"sap.m.SelectType",group:"Appearance",defaultValue:T.Default},autoAdjustWidth:{type:"boolean",group:"Appearance",defaultValue:false},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:A.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:_.Inherit},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:C.None},valueStateText:{type:"string",group:"Misc",defaultValue:""},showSecondaryValues:{type:"boolean",group:"Misc",defaultValue:false},forceSelection:{type:"boolean",group:"Behavior",defaultValue:true}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.core.Item",multiple:true,singularName:"item",bindable:"bindable",forwarding:{getter:"getList",aggregation:"items"}},picker:{type:"sap.ui.core.PopupInterface",multiple:false,visibility:"hidden"},_valueIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},_pickerHeader:{type:"sap.m.Bar",multiple:false,visibility:"hidden"}},associations:{selectedItem:{type:"sap.ui.core.Item",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{change:{parameters:{selectedItem:{type:"sap.ui.core.Item"}}}},designtime:"sap/m/designtime/Select.designtime"}});a.insertFontFaceStyle();r.apply(P.prototype,[true]);h.call(P.prototype);function L(e){if(e){this.setSelection(e);this.setValue(e.getText());this.scrollToItem(e)}}P.prototype._handleFocusout=function(e){this._bFocusoutDueRendering=this.bRenderingPhase;if(this._bFocusoutDueRendering){this._bProcessChange=false;return}if(this._bProcessChange){if(!this.isOpen()||e.target===this.getAggregation("picker")){this._checkSelectionChange()}else{this._revertSelection()}this._bProcessChange=false}else{this._bProcessChange=true}};P.prototype._checkSelectionChange=function(){var e=this.getSelectedItem();if(this._oSelectionOnFocus!==e){this.fireChange({selectedItem:e})}};P.prototype._revertSelection=function(){var e=this.getSelectedItem();if(this._oSelectionOnFocus!==e){this.setSelection(this._oSelectionOnFocus);this.setValue(this._getSelectedItemText())}};P.prototype._getSelectedItemText=function(e){e=e||this.getSelectedItem();if(!e){e=this.getDefaultSelectedItem()}if(e){return e.getText()}return""};P.prototype.getOverflowToolbarConfig=function(){var e=["enabled","selectedKey"];if(!this.getAutoAdjustWidth()||this._bIsInOverflow){e.push("selectedItemId")}var t={canOverflow:true,autoCloseEvents:["change"],invalidationEvents:["_itemTextChange"],propsUnrelatedToSize:e};t.onBeforeEnterOverflow=function(e){var t=e.getParent();if(!t.isA("sap.m.OverflowToolbar")){return}e._prevSelectType=e.getType();e._bIsInOverflow=true;if(e.getType()!==T.Default){e.setProperty("type",T.Default,true)}};t.onAfterExitOverflow=function(e){var t=e.getParent();if(!t.isA("sap.m.OverflowToolbar")){return}e._bIsInOverflow=false;if(e.getType()!==e._prevSelectType){e.setProperty("type",e._prevSelectType,true)}};return t};P.prototype.getList=function(){if(this.bIsDestroyed){return null}return this._oList};P.prototype.findFirstEnabledItem=function(e){var t=this.getList();return t?t.findFirstEnabledItem(e):null};P.prototype.findLastEnabledItem=function(e){var t=this.getList();return t?t.findLastEnabledItem(e):null};P.prototype.setSelectedIndex=function(e,t){var i;t=t||this.getItems();e=e>t.length-1?t.length-1:Math.max(0,e);i=t[e];if(i){this.setSelection(i)}};P.prototype.scrollToItem=function(e){var t=this.getPicker(),i=t.getDomRef("cont"),s=e&&e.getDomRef();if(!t||!i||!s){return}var o=i.scrollTop,r=s.offsetTop,n=i.clientHeight,a=s.offsetHeight;if(o>r){i.scrollTop=r}else if(r+a>o+n){i.scrollTop=Math.ceil(r+a-n)}};P.prototype.setValue=function(e){var t=this.getDomRef(),i=t&&t.querySelector(".sapMSelectListItemText");if(i){i.textContent=e}this._getValueIcon()};P.prototype._getValueIcon=function(){var e=this.getAggregation("_valueIcon"),t=this.getSelectedItem(),i=!!(t&&t.getIcon&&t.getIcon()),s=i?t.getIcon():"sap-icon://pull-down";if(!e){e=new n(this.getId()+"-labelIcon",{src:s,visible:false});this.setAggregation("_valueIcon",e,true)}if(e.getVisible()!==i){e.setVisible(i);e.toggleStyleClass("sapMSelectListItemIcon",i)}if(i&&t.getIcon()!==e.getSrc()){e.setSrc(s)}return e};P.prototype._isShadowListRequired=function(){if(this.getAutoAdjustWidth()){return false}else if(this.getWidth()==="auto"){return true}return false};P.prototype._handleAriaActiveDescendant=function(e){var t=this.getDomRef(),i=e&&e.getDomRef(),s="aria-activedescendant";if(!t){return}if(i&&this.isOpen()){t.setAttribute(s,e.getId())}else{t.removeAttribute(s)}};P.prototype.updateItems=function(e){i.prototype.updateItems.apply(this,arguments);this._oSelectionOnFocus=this.getSelectedItem()};P.prototype.refreshItems=function(){i.prototype.refreshItems.apply(this,arguments)};P.prototype.onBeforeOpen=function(e){var t=this["_onBeforeOpen"+this.getPickerType()],i=this.getRenderer().CSS_CLASS;this.addStyleClass(i+"Pressed");this.addStyleClass(i+"Expanded");this.closeValueStateMessage();this.addContent();t&&t.call(this)};P.prototype.onAfterOpen=function(e){var t=this.getFocusDomRef(),i=null,s=this.$("label");if(!t){return}i=this.getSelectedItem();t.setAttribute("aria-expanded","true");s.attr("aria-live",null);t.setAttribute("aria-owns",this.getList().getId());if(i){t.setAttribute("aria-activedescendant",i.getId());this.scrollToItem(i)}};P.prototype.onBeforeClose=function(e){var t=this.getFocusDomRef(),i=this.getRenderer().CSS_CLASS;if(t){t.removeAttribute("aria-owns");t.removeAttribute("aria-activedescendant");if(this.shouldValueStateMessageBeOpened()&&document.activeElement===t){this.openValueStateMessage()}}this.removeStyleClass(i+"Expanded")};P.prototype.onAfterClose=function(e){var t=this.getFocusDomRef(),i=this.getRenderer().CSS_CLASS,s=i+"Pressed",o=this.$("label");if(t){t.setAttribute("aria-expanded","false");t.removeAttribute("aria-activedescendant");o.attr("aria-live","polite")}this.removeStyleClass(s)};P.prototype.getPicker=function(){if(this.bIsDestroyed){return null}return this.createPicker(this.getPickerType())};P.prototype.setPickerType=function(e){this._sPickerType=e};P.prototype.getPickerType=function(){return this._sPickerType};P.prototype._createPopover=function(){var e=this;var i=new t({showArrow:false,showHeader:false,placement:b.VerticalPreferredBottom,offsetX:0,offsetY:0,initialFocus:this,bounce:false,ariaLabelledBy:this._getPickerHiddenLabelId()});i.addEventDelegate({ontouchstart:function(t){var i=this.getDomRef("cont");if(t.target===i||t.srcControl instanceof d){e._bProcessChange=false}}},i);this._decoratePopover(i);return i};P.prototype._decoratePopover=function(e){var t=this;e.open=function(){return this.openBy(t)}};P.prototype._onBeforeRenderingPopover=function(){var e=this.getPicker(),t=this.$().outerWidth()+"px";if(e){e.setContentMinWidth(t)}};P.prototype._createDialog=function(){var t=this;return new e({stretch:true,ariaLabelledBy:this._getPickerHiddenLabelId(),customHeader:this._getPickerHeader(),beforeOpen:function(){t.updatePickerHeaderTitle()}})};P.prototype._getPickerTitle=function(){var e=this.getPicker(),t=e&&e.getCustomHeader();if(t){return t.getContentMiddle()[0]}return null};P.prototype._getPickerHeader=function(){var e=a.getIconURI("decline"),t;if(!this.getAggregation("_pickerHeader")){t=sap.ui.getCore().getLibraryResourceBundle("sap.m");this.setAggregation("_pickerHeader",new p({contentMiddle:new c({text:t.getText("SELECT_PICKER_TITLE_TEXT")}),contentRight:new l({icon:e,press:this.close.bind(this)})}))}return this.getAggregation("_pickerHeader")};P.prototype._getPickerHiddenLabelId=function(){return y.getStaticId("sap.m","INPUT_AVALIABLE_VALUES")};P.prototype.updatePickerHeaderTitle=function(){var e=this.getPicker();if(!e){return}var t=this.getLabels();if(t.length){var i=t[0],s=this._getPickerTitle();if(i&&typeof i.getText==="function"){s&&s.setText(i.getText())}}};P.prototype._onBeforeOpenDialog=function(){};P.prototype.init=function(){this.setPickerType(f.system.phone?"Dialog":"Popover");this.createPicker(this.getPickerType());this._oSelectionOnFocus=null;this.bRenderingPhase=false;this._bFocusoutDueRendering=false;this._bProcessChange=false;this.sTypedChars="";this.iTypingTimeoutID=-1;this._oValueStateMessage=new u(this)};P.prototype.onBeforeRendering=function(){this.bRenderingPhase=true;if(f.browser.firefox&&this.getFocusDomRef()===document.activeElement){this._handleFocusout()}this.synchronizeSelection()};P.prototype.onAfterRendering=function(){this.bRenderingPhase=false};P.prototype.exit=function(){var e=this.getValueStateMessage();this._oSelectionOnFocus=null;if(e){this.closeValueStateMessage();e.destroy()}this._oValueStateMessage=null};P.prototype.ontouchstart=function(e){e.setMarked();if(this.getEnabled()&&this.isOpenArea(e.target)){this.addStyleClass(this.getRenderer().CSS_CLASS+"Pressed")}};P.prototype.ontouchend=function(e){e.setMarked();if(this.getEnabled()&&!this.isOpen()&&this.isOpenArea(e.target)){this.removeStyleClass(this.getRenderer().CSS_CLASS+"Pressed")}};P.prototype.ontap=function(e){var t=this.getRenderer().CSS_CLASS;e.setMarked();if(!this.getEnabled()){return}if(this.isOpenArea(e.target)){if(this.isOpen()){this.close();this.removeStyleClass(t+"Pressed");return}if(f.system.phone){this.focus()}this.open()}if(this.isOpen()){this.addStyleClass(t+"Pressed")}};P.prototype.onSelectionChange=function(e){var t=e.getParameter("selectedItem");this.close();this.setSelection(t);this.fireChange({selectedItem:t});this.setValue(this._getSelectedItemText())};P.prototype.onkeypress=function(e){if(!this.getEnabled()){return}e.setMarked();var t=String.fromCharCode(e.which),i=this.getSelectedItem(),s=t,o=null;this.sTypedChars+=t;var r=typeof this.sTypedChars==="string"&&this.sTypedChars!==""&&i&&i.getText().toLowerCase().startsWith(this.sTypedChars.toLowerCase());if(r||(this.sTypedChars.length===1||this.sTypedChars.length>1&&this.sTypedChars.charAt(0)!==this.sTypedChars.charAt(1))){s=this.sTypedChars}o=this.searchNextItemByText(s);clearTimeout(this.iTypingTimeoutID);this.iTypingTimeoutID=setTimeout(function(){this.sTypedChars="";this.iTypingTimeoutID=-1}.bind(this),1e3);L.call(this,o)};P.prototype.onsapshow=function(e){if(!this.getEnabled()){return}e.setMarked();if(e.which===I.F4){e.preventDefault()}this.toggleOpenState()};P.prototype.onsaphide=P.prototype.onsapshow;P.prototype.onsapescape=function(e){if(!this.getEnabled()){return}if(this.isOpen()){e.setMarked();this.close();this._revertSelection()}};P.prototype.onsapenter=function(e){if(!this.getEnabled()){return}e.setMarked();this.close();this._checkSelectionChange()};P.prototype.onsapspace=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();if(this.isOpen()){this._checkSelectionChange()}this.toggleOpenState()};P.prototype.onsapdown=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();var t,i=this.getSelectableItems();t=i[i.indexOf(this.getSelectedItem())+1];L.call(this,t)};P.prototype.onsapup=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();var t,i=this.getSelectableItems();t=i[i.indexOf(this.getSelectedItem())-1];L.call(this,t)};P.prototype.onsaphome=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();var t=this.getSelectableItems()[0];L.call(this,t)};P.prototype.onsapend=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();var t=this.findLastEnabledItem(this.getSelectableItems());L.call(this,t)};P.prototype.onsappagedown=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();var t=this.getSelectableItems(),i=this.getSelectedItem();this.setSelectedIndex(t.indexOf(i)+10,t);i=this.getSelectedItem();if(i){this.setValue(i.getText())}this.scrollToItem(i)};P.prototype.onsappageup=function(e){if(!this.getEnabled()){return}e.setMarked();e.preventDefault();var t=this.getSelectableItems(),i=this.getSelectedItem();this.setSelectedIndex(t.indexOf(i)-10,t);i=this.getSelectedItem();if(i){this.setValue(i.getText())}this.scrollToItem(i)};P.prototype.onsaptabnext=function(e){if(!this.getEnabled()){return}if(this.isOpen()){this.close();this._checkSelectionChange()}};P.prototype.onsaptabprevious=P.prototype.onsaptabnext;P.prototype.onfocusin=function(e){if(!this._bFocusoutDueRendering&&!this._bProcessChange){this._oSelectionOnFocus=this.getSelectedItem()}this._bProcessChange=true;setTimeout(function(){if(!this.isOpen()&&this.shouldValueStateMessageBeOpened()&&document.activeElement===this.getFocusDomRef()){this.openValueStateMessage()}}.bind(this),100);if(e.target!==this.getFocusDomRef()){this.focus()}};P.prototype.onfocusout=function(e){this._handleFocusout(e);if(this.bRenderingPhase){return}this.closeValueStateMessage()};P.prototype.onsapfocusleave=function(e){var t=this.getAggregation("picker");if(!e.relatedControlId||!t){return}var i=sap.ui.getCore().byId(e.relatedControlId),s=i&&i.getFocusDomRef();if(f.system.desktop&&S(t.getFocusDomRef(),s)){this.focus()}};P.prototype.setSelection=function(e){var t=this.getList(),i;if(t){t.setSelection(e)}this.setAssociation("selectedItem",e,true);this.setProperty("selectedItemId",e instanceof d?e.getId():e,true);if(typeof e==="string"){e=sap.ui.getCore().byId(e)}i=e?e.getKey():"";this.setProperty("selectedKey",i,true);this._handleAriaActiveDescendant(e)};P.prototype.isSelectionSynchronized=function(){var e=this.getSelectedItem();return this.getSelectedKey()===(e&&e.getKey())};P.prototype.synchronizeSelection=function(){i.prototype.synchronizeSelection.apply(this,arguments)};P.prototype.addContent=function(e){};P.prototype.createPicker=function(e){var t=this.getAggregation("picker"),i=this.getRenderer().CSS_CLASS;if(t){return t}t=this["_create"+e]();this.setAggregation("picker",t,true);t.setHorizontalScrolling(false).addStyleClass(i+"Picker").addStyleClass(i+"Picker-CTX").attachBeforeOpen(this.onBeforeOpen,this).attachAfterOpen(this.onAfterOpen,this).attachBeforeClose(this.onBeforeClose,this).attachAfterClose(this.onAfterClose,this).addEventDelegate({onBeforeRendering:this.onBeforeRenderingPicker,onAfterRendering:this.onAfterRenderingPicker},this).addContent(this.createList());return t};P.prototype.searchNextItemByText=function(e){var t=this.getItems(),i=this.getSelectedIndex(),s=t.splice(i+1,t.length-i),o=t.splice(0,t.length-1);t=s.concat(o);for(var r=0,n;r<t.length;r++){n=t[r];var a=typeof e==="string"&&e!=="";if(n.getEnabled()&&!(n instanceof sap.ui.core.SeparatorItem)&&n.getText().toLowerCase().startsWith(e.toLowerCase())&&a){return n}}return null};P.prototype.createList=function(){var e=v,t=f.system.phone?e.Delimited:e.None;this._oList=new i({width:"100%",keyboardNavigationMode:t}).addStyleClass(this.getRenderer().CSS_CLASS+"List-CTX").addEventDelegate({ontap:function(e){this._checkSelectionChange();this.close()}},this).attachSelectionChange(this.onSelectionChange,this);return this._oList};P.prototype.hasContent=function(){return this.getItems().length>0};P.prototype.onBeforeRenderingPicker=function(){var e=this["_onBeforeRendering"+this.getPickerType()];e&&e.call(this)};P.prototype.onAfterRenderingPicker=function(){var e=this["_onAfterRendering"+this.getPickerType()];e&&e.call(this)};P.prototype.open=function(){var e=this.getPicker();if(e){e.open()}return this};P.prototype.toggleOpenState=function(){if(this.isOpen()){this.close()}else{this.open()}return this};P.prototype.getVisibleItems=function(){var e=this.getList();return e?e.getVisibleItems():[]};P.prototype.isItemSelected=function(e){return e&&e.getId()===this.getAssociation("selectedItem")};P.prototype.getSelectedIndex=function(){var e=this.getSelectedItem();return e?this.indexOfItem(this.getSelectedItem()):-1};P.prototype.getDefaultSelectedItem=function(e){return this.getForceSelection()?this.findFirstEnabledItem():null};P.prototype.getSelectableItems=function(){var e=this.getList();return e?e.getSelectableItems():[]};P.prototype.getOpenArea=function(){return this.getDomRef()};P.prototype.isOpenArea=function(e){var t=this.getOpenArea();return t&&t.contains(e)};P.prototype.findItem=function(e,t){var i=this.getList();return i?i.findItem(e,t):null};P.prototype.clearSelection=function(){this.setSelection(null)};P.prototype.onItemChange=function(e){var t=this.getAssociation("selectedItem"),i=e.getParameter("newValue"),s=e.getParameter("name");if(t===e.getParameter("id")||this.getSelectedKey()===e.oSource.getKey()){switch(s){case"text":this.fireEvent("_itemTextChange");this.setValue(i);break;case"key":if(!this.isBound("selectedKey")){this.setSelectedKey(i)}break}}};P.prototype.fireChange=function(e){this._oSelectionOnFocus=e.selectedItem;return this.fireEvent("change",e)};P.prototype.addAggregation=function(e,t,i){if(e==="items"&&!i&&!this.isInvalidateSuppressed()){this.invalidate(t)}return o.prototype.addAggregation.apply(this,arguments)};P.prototype.destroyAggregation=function(e,t){if(e==="items"&&!t&&!this.isInvalidateSuppressed()){this.invalidate()}return o.prototype.destroyAggregation.apply(this,arguments)};P.prototype.setAssociation=function(e,t,s){var r=this.getList();if(r&&e==="selectedItem"){i.prototype.setAssociation.apply(r,arguments)}return o.prototype.setAssociation.apply(this,arguments)};P.prototype.setProperty=function(e,t,s){var r=this.getList();if(e==="selectedKey"||e==="selectedItemId"){r&&i.prototype.setProperty.apply(r,arguments)}return o.prototype.setProperty.apply(this,arguments)};P.prototype.removeAllAssociation=function(e,t){var s=this.getList();if(s&&e==="selectedItem"){i.prototype.removeAllAssociation.apply(s,arguments)}return o.prototype.removeAllAssociation.apply(this,arguments)};P.prototype.clone=function(){var e=o.prototype.clone.apply(this,arguments),t=this.getSelectedItem(),i=this.getSelectedKey();if(!this.isBound("selectedKey")&&!e.isSelectionSynchronized()){if(t&&i===""){e.setSelectedIndex(this.indexOfItem(t))}else{e.setSelectedKey(i)}}return e};P.prototype.updateValueStateClasses=function(e,t){var i=this.$(),s=this.$("label"),o=this.$("arrow"),r=C,n=this.getRenderer().CSS_CLASS;if(t!==r.None){i.removeClass(n+"State");i.removeClass(n+t);s.removeClass(n+"LabelState");s.removeClass(n+"Label"+t);o.removeClass(n+"ArrowState")}if(e!==r.None){i.addClass(n+"State");i.addClass(n+e);s.addClass(n+"LabelState");s.addClass(n+"Label"+e);o.addClass(n+"ArrowState")}};P.prototype.updateAriaLabelledBy=function(e,t){var i=this.$(),s=i.attr("aria-labelledby"),o=s?s.split(" "):[],r;if(t!==C.None){o.pop()}if(e!==C.None){o.push(y.getStaticId("sap.ui.core","VALUE_STATE_"+e.toUpperCase()))}r=o.join(" ");i.attr("aria-labelledby",r)};P.prototype.getLabels=function(){var e=this.getAriaLabelledBy().map(function(e){return sap.ui.getCore().byId(e)});var t=sap.ui.require("sap/ui/core/LabelEnablement");if(t){e=e.concat(t.getReferencingLabels(this).map(function(e){return sap.ui.getCore().byId(e)}))}return e};P.prototype.getDomRefForValueStateMessage=function(){return this.getDomRef()};P.prototype.getValueStateMessageId=function(){return this.getId()+"-message"};P.prototype.getValueStateMessage=function(){return this._oValueStateMessage};P.prototype.openValueStateMessage=function(){var e=this.getValueStateMessage();if(e){e.open()}};P.prototype.closeValueStateMessage=function(){var e=this.getValueStateMessage();if(e){e.close()}};P.prototype.shouldValueStateMessageBeOpened=function(){return this.getValueState()!==C.None&&this.getEnabled()};P.prototype.setShowSecondaryValues=function(e){var t=!this._isShadowListRequired();this.setProperty("showSecondaryValues",e,t);var i=this.getList();if(i){i.setShowSecondaryValues(e)}return this};P.prototype.addItem=function(e){this.addAggregation("items",e);if(e){e.attachEvent("_change",this.onItemChange,this)}return this};P.prototype.insertItem=function(e,t){this.insertAggregation("items",e,t);if(e){e.attachEvent("_change",this.onItemChange,this)}return this};P.prototype.findAggregatedObjects=function(){var e=this.getList();if(e){return i.prototype.findAggregatedObjects.apply(e,arguments)}return[]};P.prototype.getItems=function(){var e=this.getList();return e?e.getItems():[]};P.prototype.setSelectedItem=function(e){if(typeof e==="string"){this.setAssociation("selectedItem",e,true);e=sap.ui.getCore().byId(e)}if(!(e instanceof d)&&e!==null){return this}if(!e){e=this.getDefaultSelectedItem()}this.setSelection(e);this.setValue(this._getSelectedItemText(e));this._oSelectionOnFocus=e;return this};P.prototype.setSelectedItemId=function(e){e=this.validateProperty("selectedItemId",e);if(!e){e=this.getDefaultSelectedItem()}this.setSelection(e);this.setValue(this._getSelectedItemText());this._oSelectionOnFocus=sap.ui.getCore().byId(e);return this};P.prototype.setSelectedKey=function(e){e=this.validateProperty("selectedKey",e);var t=e==="";if(!this.getForceSelection()&&t){this.setSelection(null);this.setValue("");return this}var i=this.getItemByKey(e);if(i||t){if(!i&&t){i=this.getDefaultSelectedItem()}this.setSelection(i);this.setValue(this._getSelectedItemText(i));this._oSelectionOnFocus=i;return this}return this.setProperty("selectedKey",e)};P.prototype.setValueState=function(e){var t=this.getValueState();this.setProperty("valueState",e,true);e=this.getValueState();if(e===t){return this}var i=this.getDomRefForValueState();if(!i){return this}var s=C;if(e===s.Error){i.setAttribute("aria-invalid",true)}else{i.removeAttribute("aria-invalid")}if(this.shouldValueStateMessageBeOpened()&&document.activeElement===i){this.openValueStateMessage()}else{this.closeValueStateMessage()}this.updateValueStateClasses(e,t);this.updateAriaLabelledBy(e,t);return this};P.prototype.getItemAt=function(e){return this.getItems()[+e]||null};P.prototype.getSelectedItem=function(){var e=this.getAssociation("selectedItem");return e===null?null:sap.ui.getCore().byId(e)||null};P.prototype.getFirstItem=function(){return this.getItems()[0]||null};P.prototype.getLastItem=function(){var e=this.getItems();return e[e.length-1]||null};P.prototype.getEnabledItems=function(e){var t=this.getList();return t?t.getEnabledItems(e):[]};P.prototype.getItemByKey=function(e){var t=this.getList();return t?t.getItemByKey(e):null};P.prototype.removeItem=function(e){var t;e=this.removeAggregation("items",e);if(this.getItems().length===0){this.clearSelection()}else if(this.isItemSelected(e)){t=this.findFirstEnabledItem();if(t){this.setSelection(t)}}this.setValue(this._getSelectedItemText());if(e){e.detachEvent("_change",this.onItemChange,this)}return e};P.prototype.removeAllItems=function(){var e=this.removeAllAggregation("items");this.setValue("");if(this._isShadowListRequired()){this.$().find(".sapMSelectListItemBase").remove()}for(var t=0;t<e.length;t++){e[t].detachEvent("_change",this.onItemChange,this)}return e};P.prototype.destroyItems=function(){this.destroyAggregation("items");this.setValue("");if(this._isShadowListRequired()){this.$().find(".sapMSelectListItemBase").remove()}return this};P.prototype.isOpen=function(){var e=this.getAggregation("picker");return!!(e&&e.isOpen())};P.prototype.close=function(){var e=this.getAggregation("picker");if(e){e.close()}return this};P.prototype.getDomRefForValueState=function(){return this.getDomRef()};P.prototype.getAccessibilityInfo=function(){var e={role:this.getRenderer().getAriaRole(this),focusable:this.getEnabled(),enabled:this.getEnabled()};if(this.getType()==="IconOnly"){var t=this.getTooltip_AsString();if(!t){var i=a.getIconInfo(this.getIcon());t=i&&i.text?i.text:""}e.type=sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("ACC_CTR_TYPE_BUTTON");e.description=t}else if(this.getType()==="Default"){e.type=sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("ACC_CTR_TYPE_COMBO");e.description=this._getSelectedItemText()}return e};P.prototype.getIdForLabel=function(){return this.getId()+"-hiddenInput"};return P});