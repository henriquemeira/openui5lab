/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","./Tokenizer","sap/ui/core/library","sap/ui/core/Icon","./TokenRenderer","sap/ui/events/KeyCodes","sap/ui/core/theming/Parameters"],function(e,t,i,s,n,o,r,a){"use strict";var l=s.TextDirection;var c=t.extend("sap.m.Token",{metadata:{library:"sap.m",properties:{selected:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:""},text:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:l.Inherit}},aggregations:{deleteIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{delete:{},press:{},select:{},deselect:{}}}});c.prototype.init=function(){var e=this,t=a.get("_sap_m_Token_Sys_Cancel_Icon")==="true",s=t?"sap-icon://sys-cancel":"sap-icon://decline";this._deleteIcon=new n({id:e.getId()+"-icon",src:s,noTabStop:true,press:function(t){var s=e.getParent();e.fireDelete({token:e});if(s instanceof i){s._onTokenDelete(e)}t.preventDefault()}});this._deleteIcon.addStyleClass("sapMTokenIcon");this.setAggregation("deleteIcon",this._deleteIcon);this._deleteIcon.setUseIconTooltip(false)};c.prototype.ontouchstart=function(e){if(e.target.id===this.getId()+"-icon"){e.preventDefault()}};c.prototype.setSelected=function(e){if(this.getSelected()===e){return this}var t=this.$();if(t){t.toggleClass("sapMTokenSelected",e);t.attr("aria-selected",e)}this.setProperty("selected",e,true);return this};c.prototype.setEditable=function(e){var t=this.getParent();this.setProperty("editable",e,true);this.$().toggleClass("sapMTokenReadOnly",!e);if(t instanceof i){t.invalidate()}return this};c.prototype._onTokenPress=function(e){var t=this.getSelected(),s=e.ctrlKey||e.metaKey,n=e.shiftKey,o=true,r;if(s){o=!t}this.setSelected(o);this.firePress();if(t!=o){if(o){this.fireSelect()}else{this.fireDeselect()}}r=this.getParent();if(r instanceof i){r._onTokenSelect(this,s,n)}if(this.getSelected()){this.focus()}};c.prototype._changeSelection=function(e){if(this.getSelected()==e){return}this.setSelected(e);if(e){this.fireSelect()}else{this.fireDeselect()}};c.prototype.ontap=function(e){if(e.target.id==this._deleteIcon.getId()){e.setMark("tokenDeletePress",true);return}this._onTokenPress(e)};c.prototype.onsapfocusleave=function(e){if(this.getParent()instanceof i){return}this.setSelected(false)};c.prototype.onsapbackspace=function(e){this._deleteToken(e)};c.prototype.onsapdelete=function(e){this._deleteToken(e)};c.prototype._deleteToken=function(e){if(this.getParent()instanceof i){return}if(this.getEditable()){this.fireDelete({token:this})}e.preventDefault()};c.prototype.onsapspace=function(e){this._onTokenPress(e);if(e){e.preventDefault();e.stopPropagation()}};c.prototype.onkeydown=function(e){if((e.ctrlKey||e.metaKey)&&e.which===r.SPACE){this.onsapspace(e);e.preventDefault()}};return c});