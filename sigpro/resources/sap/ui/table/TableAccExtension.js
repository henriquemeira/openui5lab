/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","./library","./TableExtension","./TableAccRenderExtension","./TableUtils","sap/ui/Device","sap/ui/thirdparty/jquery"],function(e,t,a,i,r,l,o){"use strict";var n=t.SelectionMode;var s=r.CELLTYPE;var u={getAccInfoOfControl:function(e){if(e&&typeof e.getAccessibilityInfo==="function"){if(typeof e.getVisible==="function"&&!e.getVisible()){return u._normalize({})}var t=e.getAccessibilityInfo();if(t){var a={};u._flatten(t,a);return a}}return null},_normalize:function(e){if(!e){return null}if(e._normalized){return e}e.role=e.role||"";e.type=e.type||"";e.description=e.description||"";e.enabled=e.enabled===true||e.enabled===false?e.enabled:null;e.editable=e.editable===true||e.editable===false?e.editable:null;e.children=e.children||[];e._normalized=true;return e},_flatten:function(e,t,a){a=a?a:0;u._normalize(e);if(a==0){u._normalize(t);t._descriptions=[]}t._descriptions.push(u._getFullDescription(e));e.children.forEach(function(e){if(!e.getAccessibilityInfo||e.getVisible&&!e.getVisible()){return}var i=e.getAccessibilityInfo();if(i){u._flatten(i,t,a+1)}});if(a==0){t.description=t._descriptions.join(" ").trim();t._descriptions=undefined}},_getFullDescription:function(e){var t=e.type+" "+e.description;if(e.enabled===false){t=t+" "+r.getResourceText("TBL_CTRL_STATE_DISABLED")}else if(e.editable===false){t=t+" "+r.getResourceText("TBL_CTRL_STATE_READONLY")}return t.trim()}};var d={getColumnIndexOfFocusedCell:function(e){var t=e.getTable();var a=r.getFocusedItemInfo(t);return a.cellInRow-(r.hasRowHeader(t)?1:0)},getInfoOfFocusedCell:function(e){var t=e.getTable();var a=t._getItemNavigation();var i=t.getDomRef();if(!e.getAccMode()||!i||!a){return null}var l=a.getFocusedDomRef();if(!l||l!==document.activeElement){return null}return r.getCellInfo(l)},getRelevantColumnHeaders:function(e,t){if(!e||!t){return[]}var a=r.getHeaderRowCount(e),i=t.getId(),l=[i];if(a>1){for(var o=1;o<a;o++){l.push(i+"_"+o)}var n=r.Column.getParentSpannedColumns(e,i);if(n&&n.length){for(var o=0;o<n.length;o++){var s=n[o].level;var u=n[o].column.getId();l[s]=s===0?u:u+"_"+s}}}return l},isHiddenCell:function(e,t){var a=r.Grouping.isInGroupingRow(e);var i=r.Grouping.isInSumRow(e);var l=!!t&&!!t.hasStyleClass;var o=e.parent().hasClass("sapUiTableRowHidden");var n=e.hasClass("sapUiTableCellHidden");var s=a&&e.hasClass("sapUiTableTdFirst")&&!e.hasClass("sapUiTableMeasureCell");var u=a&&l&&t.hasStyleClass("sapUiAnalyticalTableGroupCellHidden");var d=i&&l&&t.hasStyleClass("sapUiAnalyticalTableSumCellHidden");return o||n||s||u||d},isTreeColumnCell:function(e,t){return r.Grouping.isTreeMode(e.getTable())&&t.hasClass("sapUiTableTdFirst")},getColumnTooltip:function(t){if(!t){return null}var a=t.getTooltip_AsString();if(a){return a}var i=t.getLabel();if(i instanceof e){a=i.getTooltip_AsString()}if(a){return a}return null},updateRowColCount:function(e){var t=e.getTable(),a=t._getItemNavigation(),i=false,l=false,o=false;if(a){var n=d.getColumnIndexOfFocusedCell(e)+1;var s=r.getRowIndexOfFocusedCell(t)+t._getFirstRenderedRowIndex()+1;var u=r.getVisibleColumnCount(t)+(r.hasRowActions(t)?1:0);var c=r.isNoDataVisible(t)?0:r.getTotalRowCount(t,true);i=e._iLastRowNumber!=s||e._iLastRowNumber==s&&e._iLastColumnNumber==n;l=e._iLastColumnNumber!=n;o=!e._iLastRowNumber&&!e._iLastColumnNumber;t.$("rownumberofrows").text(i?r.getResourceText("TBL_ROW_ROWCOUNT",[s,c]):" ");t.$("colnumberofcols").text(l?r.getResourceText("TBL_COL_COLCOUNT",[n,u]):" ");t.$("ariacount").text(o?r.getResourceText("TBL_DATA_ROWS_COLS",[c,u]):" ");e._iLastRowNumber=s;e._iLastColumnNumber=n}return{rowChange:i,colChange:l,initial:o}},cleanupCellModifications:function(e){if(e._cleanupInfo){e._cleanupInfo.cell.attr(e._cleanupInfo.attr);e._cleanupInfo=null}},storeDefaultsBeforeCellModifications:function(e,t,a,i){e._cleanupInfo={cell:t,attr:{"aria-labelledby":a&&a.length?a.join(" "):null,"aria-describedby":i&&i.length?i.join(" "):null}}},performCellModifications:function(e,t,a,i,r,l,o,s){d.storeDefaultsBeforeCellModifications(e,t,a,i);var u=d.updateRowColCount(e);e.getTable().$("cellacc").text(o||" ");if(s){s(r,l,u.rowChange,u.colChange,u.initial)}var c="";if(u.initial){var E=e.getTable();c=E.getAriaLabelledBy().join(" ")+" "+E.getId()+"-ariadesc "+E.getId()+"-ariacount";if(E.getSelectionMode()!==n.None){c=c+" "+E.getId()+"-ariaselection"}}if(r&&r.length){c=c+" "+r.join(" ")}t.attr({"aria-labelledby":c?c:null,"aria-describedby":l&&l.length?l.join(" "):null})},modifyAccOfDATACELL:function(e){var t=this.getTable(),a=t.getId(),i=t._getItemNavigation();if(!i){return}var l=r.getRowIndexOfFocusedCell(t),o=d.getColumnIndexOfFocusedCell(this),n=r.getRowColCell(t,l,o,false),s=null,E=d.isHiddenCell(e,n.cell),f=d.isTreeColumnCell(this,e),g=r.Grouping.isInGroupingRow(e),T=r.Grouping.isInSumRow(e),p=d.getAriaAttributesFor(this,c.ELEMENTTYPES.DATACELL,{index:o,column:n.column,fixed:r.isFixedColumn(t,o)})["aria-labelledby"]||[],b=[],h=[a+"-rownumberofrows",a+"-colnumberofcols"];if(g){h.push(a+"-ariarowgrouplabel");h.push(a+"-rows-row"+l+"-groupHeader")}if(T){var C=e.parent().data("sap-ui-level");if(C==0){h.push(a+"-ariagrandtotallabel")}else if(C>0){h.push(a+"-ariagrouptotallabel");h.push(a+"-rows-row"+l+"-groupHeader")}}if(r.hasRowHighlights(t)&&!g&&!T){h.push(n.row.getId()+"-highlighttext")}h=h.concat(p);if(!E){s=u.getAccInfoOfControl(n.cell);h.push(s?a+"-cellacc":n.cell.getId());if(r.getInteractiveElements(e)!==null){b.push(a+"-toggleedit")}if(r.Grouping.isTreeMode(t)&&!!e.parent().attr("aria-selected")){h.push(a+"-ariarowselected")}}var A=s?s.description:" ";if(f&&!E){var R=d.getAriaAttributesFor(this,c.ELEMENTTYPES.TREEICON,{row:n.row});if(R&&R["aria-label"]){A=R["aria-label"]+" "+A}}d.performCellModifications(this,e,p,null,h,b,A,function(a,i,l,o,s){var u=e.find(".sapUiTableTreeIcon").length==1;if((u||r.Grouping.isInGroupingRow(e))&&(l||o)){i.push(t.getId()+(!n.row._bIsExpanded?"-rowexpandtext":"-rowcollapsetext"))}else if(!E&&r.isRowSelectionAllowed(t)&&l){i.push(n.row.getId()+"-rowselecttext")}})},modifyAccOfROWHEADER:function(e){var t=this.getTable(),a=t.getId(),i=r.Grouping.isInGroupingRow(e),l=r.Grouping.isInSumRow(e),o=t.getRows()[e.attr("data-sap-ui-rowindex")],n=d.getAriaAttributesFor(this,c.ELEMENTTYPES.ROWHEADER)["aria-labelledby"]||[],s=n.concat([a+"-rownumberofrows"]);if(!l&&!i){if(!e.hasClass("sapUiTableRowHidden")){s.push(o.getId()+"-rowselecttext");if(r.hasRowHighlights(t)){s.push(o.getId()+"-highlighttext")}}}if(i){s.push(a+"-ariarowgrouplabel");s.push(a+(o._bIsExpanded?"-rowcollapsetext":"-rowexpandtext"))}if(l){var u=e.data("sap-ui-level");if(u==0){s.push(a+"-ariagrandtotallabel")}else if(u>0){s.push(a+"-ariagrouptotallabel")}}d.performCellModifications(this,e,n,null,s,null,null)},modifyAccOfCOLUMNHEADER:function(e){var t=this.getTable(),a=sap.ui.getCore().byId(e.attr("data-sap-ui-colid")),i=d.getAriaAttributesFor(this,c.ELEMENTTYPES.COLUMNHEADER,{headerId:e.attr("id"),column:a,index:e.attr("data-sap-ui-colindex")}),l=d.getColumnTooltip(a),o=[t.getId()+"-colnumberofcols"].concat(i["aria-labelledby"]),n=r.getCellInfo(e),s=n.columnSpan;if(s>1){o.push(t.getId()+"-ariacolspan");t.$("ariacolspan").text(r.getResourceText("TBL_COL_DESC_SPAN",[""+s]))}if(l){o.push(t.getId()+"-cellacc")}if(s<=1&&a&&a.getSorted()){o.push(t.getId()+(a.getSortOrder()==="Ascending"?"-ariacolsortedasc":"-ariacolsorteddes"))}if(s<=1&&a&&a.getFiltered()){o.push(t.getId()+"-ariacolfiltered")}if(s<=1&&e.attr("aria-haspopup")==="true"){o.push(t.getId()+"-ariacolmenu")}d.performCellModifications(this,e,i["aria-labelledby"],i["aria-describedby"],o,i["aria-describedby"],l)},modifyAccOfCOLUMNROWHEADER:function(e){var t=this.getTable(),a=e.hasClass("sapUiTableSelAllEnabled");t.$("sapUiTableGridCnt").removeAttr("role");var i=d.getAriaAttributesFor(this,c.ELEMENTTYPES.COLUMNROWHEADER,{enabled:a,checked:a&&!t.$().hasClass("sapUiTableSelAll")});d.performCellModifications(this,e,i["aria-labelledby"],i["aria-describedby"],i["aria-labelledby"],i["aria-describedby"],null)},modifyAccOfROWACTION:function(e){var t=this.getTable(),a=t.getId(),i=r.Grouping.isInGroupingRow(e),l=r.Grouping.isInSumRow(e),o=e.attr("data-sap-ui-rowindex"),n=t.getRows()[o],s=d.isHiddenCell(e),u=d.getAriaAttributesFor(this,c.ELEMENTTYPES.ROWACTION)["aria-labelledby"]||[],E=[a+"-rownumberofrows",a+"-colnumberofcols"].concat(u),f=[];if(i){E.push(a+"-ariarowgrouplabel");E.push(a+"-rows-row"+o+"-groupHeader");E.push(a+(n._bIsExpanded?"-rowcollapsetext":"-rowexpandtext"))}if(l){var g=e.data("sap-ui-level");if(g==0){E.push(a+"-ariagrandtotallabel")}else if(g>0){E.push(a+"-ariagrouptotallabel");E.push(a+"-rows-row"+o+"-groupHeader")}}if(!l&&!i&&e.attr("aria-selected")=="true"){E.push(a+"-ariarowselected")}if(r.hasRowHighlights(t)&&!i&&!l){E.push(n.getId()+"-highlighttext")}var T="";if(!s){var p=n.getAggregation("_rowAction");if(p){var b=p.getAccessibilityInfo();if(b){E.push(a+"-cellacc");T=b.description;if(r.getInteractiveElements(e)!==null){f.push(a+"-toggleedit")}}}}d.performCellModifications(this,e,u,[],E,f,T)},getAriaAttributesFor:function(t,a,i){var l={},o=t.getTable(),s=o.getId();function u(e,t,a,i){var o="";if(a&&i){o="overlay,nodata"}else if(a&&!i){o="overlay"}else if(!a&&i){o="nodata"}var n=false;if(a&&e.getShowOverlay()||i&&r.isNoDataVisible(e)){n=true}if(n){l["aria-hidden"]="true"}if(o){l["data-sap-ui-table-acc-covered"]=o}}switch(a){case c.ELEMENTTYPES.COLUMNROWHEADER:l["aria-labelledby"]=[s+"-ariacolrowheaderlabel"];var E=false;l["role"]=["button"];if(i&&i.enabled){l["aria-pressed"]=i.checked?"true":"false"}else{E=true;l["aria-disabled"]="true";l["aria-pressed"]="false"}if(E||!o._getShowStandardTooltips()){l["aria-labelledby"].push(s+"-ariaselectall")}break;case c.ELEMENTTYPES.ROWHEADER:l["aria-labelledby"]=[s+"-ariarowheaderlabel"];if(!r.Grouping.isTreeMode(o)){l["role"]=["rowheader"]}if(o.getSelectionMode()!==n.None&&(!i||!i.rowHidden)){var f=i&&i.rowSelected;l["aria-selected"]=""+f;var g=t.getAriaTextsForSelectionMode(true);l["title"]=g.mouse[f?"rowDeselect":"rowSelect"]}break;case c.ELEMENTTYPES.ROWACTION:l["role"]=["gridcell"];l["aria-labelledby"]=[s+"-rowacthdr"];if(o.getSelectionMode()!==n.None&&(!i||!i.rowHidden)){var f=i&&i.rowSelected;l["aria-selected"]=""+f}break;case c.ELEMENTTYPES.COLUMNHEADER:var T=i&&i.column;var p=i&&i.colspan;l["role"]="columnheader";var b=[];if(i&&i.headerId){var h=d.getRelevantColumnHeaders(o,T);var C=h.indexOf(i.headerId);b=C>0?h.slice(0,C+1):[i.headerId]}for(var A=0;A<b.length;A++){b[A]=b[A]+"-inner"}l["aria-labelledby"]=b;if(i&&i.index<o.getComputedFixedColumnCount()){l["aria-labelledby"].push(s+"-ariafixedcolumn")}if(!p&&T&&T.getSorted()){l["aria-sort"]=T.getSortOrder()==="Ascending"?"ascending":"descending"}if(!p&&T&&T._menuHasItems()){l["aria-haspopup"]="true"}break;case c.ELEMENTTYPES.DATACELL:l["role"]="gridcell";var b=[],T=i&&i.column?i.column:null;if(T){b=d.getRelevantColumnHeaders(o,T);l["headers"]=b.join(" ");for(var A=0;A<b.length;A++){b[A]=b[A]+"-inner"}if(i&&i.fixed){b.push(s+"-ariafixedcolumn")}}l["aria-labelledby"]=b;if(r.Grouping.isTreeMode(o)&&i&&i.firstCol&&i.row){var R=o.mBindingInfos["rows"];if(i.row.getBindingContext(R&&R.model)){l["aria-level"]=i.row._iLevel+1;l["aria-expanded"]=""+i.row._bIsExpanded}}break;case c.ELEMENTTYPES.ROOT:break;case c.ELEMENTTYPES.TABLE:l["role"]="presentation";u(o,l,true,true);break;case c.ELEMENTTYPES.CONTENT:l["role"]=r.Grouping.isGroupMode(o)||r.Grouping.isTreeMode(o)?"treegrid":"grid";l["aria-labelledby"]=[].concat(o.getAriaLabelledBy());if(o.getTitle()){l["aria-labelledby"].push(o.getTitle().getId())}if(o.getSelectionMode()===n.MultiToggle){l["aria-multiselectable"]="true"}break;case c.ELEMENTTYPES.TABLEHEADER:l["role"]="heading";u(o,l,true,false);break;case c.ELEMENTTYPES.COLUMNHEADER_TBL:l["role"]="presentation";break;case c.ELEMENTTYPES.COLUMNHEADER_ROW:l["role"]="row";u(o,l,true,false);break;case c.ELEMENTTYPES.ROWHEADER_COL:u(o,l,true,true);break;case c.ELEMENTTYPES.TH:var L=o.getComputedFixedColumnCount()>0;if(!L){l["role"]="presentation"}l["scope"]="col";if(L){if(i&&i.column){l["aria-owns"]=i.column.getId();l["aria-labelledby"]=[i.column.getId()]}}else{l["aria-hidden"]="true"}break;case c.ELEMENTTYPES.ROWHEADER_TD:l["role"]="rowheader";l["aria-labelledby"]=[s+"-ariarowheaderlabel"];l["headers"]=s+"-colsel";if(i&&typeof i.index==="number"){l["aria-owns"]=s+"-rowsel"+i.index}if(o.getSelectionMode()!==n.None){var f=i&&i.rowSelected;l["aria-selected"]=""+f}break;case c.ELEMENTTYPES.TR:l["role"]="row";var f=false;if(i&&typeof i.index==="number"&&o.getSelectionMode()!==n.None&&o.isIndexSelected(i.index)){l["aria-selected"]="true";f=true}if(r.isRowSelectionAllowed(o)&&o.getContextByIndex(i.index)){var g=t.getAriaTextsForSelectionMode(true);l["title"]=g.mouse[f?"rowDeselect":"rowSelect"]}break;case c.ELEMENTTYPES.TREEICON:if(r.Grouping.isTreeMode(o)){l={"aria-label":"",title:"",role:""};if(o.getBinding("rows")){l["role"]="button";if(i&&i.row){if(i.row._bHasChildren){var _=r.getResourceText(i.row._bIsExpanded?"TBL_COLLAPSE":"TBL_EXPAND");if(o._getShowStandardTooltips()){l["title"]=_}else{l["aria-label"]=_}l["aria-expanded"]=""+!!i.row._bIsExpanded;l["aria-hidden"]="false"}else{l["aria-label"]=r.getResourceText("TBL_LEAF");l["aria-hidden"]="true"}}}}break;case c.ELEMENTTYPES.NODATA:l["role"]="gridcell";var O=o.getNoData();l["aria-labelledby"]=[O instanceof e?O.getId():s+"-noDataMsg"];u(o,l,true,false);break;case c.ELEMENTTYPES.OVERLAY:l["role"]="region";l["aria-labelledby"]=[].concat(o.getAriaLabelledBy());if(o.getTitle()){l["aria-labelledby"].push(o.getTitle().getId())}l["aria-labelledby"].push(s+"-ariainvalid");break;case c.ELEMENTTYPES.TABLEFOOTER:case c.ELEMENTTYPES.TABLESUBHEADER:u(o,l,true,false);break;case c.ELEMENTTYPES.ROWACTIONHEADER:l["aria-hidden"]="true";break;case"PRESENTATION":l["role"]="presentation";break}return l}};var c=a.extend("sap.ui.table.TableAccExtension",{_init:function(e,t,r){this._accMode=sap.ui.getCore().getConfiguration().getAccessibility();this._busyCells=[];e.addEventDelegate(this);a.enrich(e,i);return"AccExtension"},_debug:function(){this._ExtensionHelper=d;this._ACCInfoHelper=u},destroy:function(){this.getTable().removeEventDelegate(this);this._busyCells=[];a.prototype.destroy.apply(this,arguments)},getAriaAttributesFor:function(e,t){return d.getAriaAttributesFor(this,e,t)},onfocusin:function(e){var t=this.getTable();if(!t||r.getCellInfo(e.target).cell==null){return}if(t._mTimeouts._cleanupACCExtension){clearTimeout(t._mTimeouts._cleanupACCExtension);t._mTimeouts._cleanupACCExtension=null}this.updateAccForCurrentCell("Focus")},onfocusout:function(e){var t=this.getTable();if(!t){return}t.$("sapUiTableGridCnt").attr("role",d.getAriaAttributesFor(this,"CONTENT",{}).role);t._mTimeouts._cleanupACCExtension=setTimeout(function(){var e=this.getTable();if(!e){return}this._iLastRowNumber=null;this._iLastColumnNumber=null;d.cleanupCellModifications(this);e._mTimeouts._cleanupACCExtension=null}.bind(this),100)}});c.ELEMENTTYPES={DATACELL:"DATACELL",COLUMNHEADER:"COLUMNHEADER",ROWHEADER:"ROWHEADER",ROWACTION:"ROWACTION",COLUMNROWHEADER:"COLUMNROWHEADER",ROOT:"ROOT",CONTENT:"CONTENT",TABLE:"TABLE",TABLEHEADER:"TABLEHEADER",TABLEFOOTER:"TABLEFOOTER",TABLESUBHEADER:"TABLESUBHEADER",COLUMNHEADER_TBL:"COLUMNHEADER_TABLE",COLUMNHEADER_ROW:"COLUMNHEADER_ROW",ROWHEADER_COL:"ROWHEADER_COL",TH:"TH",ROWHEADER_TD:"ROWHEADER_TD",TR:"TR",TREEICON:"TREEICON",ROWACTIONHEADER:"ROWACTIONHEADER",NODATA:"NODATA",OVERLAY:"OVERLAY"};c.prototype.getAccMode=function(){return this._accMode};c.prototype.updateAccForCurrentCell=function(e){if(!this._accMode||!this.getTable()._getItemNavigation()){return}if(e==="Focus"||e===r.RowsUpdateReason.Expand||e===r.RowsUpdateReason.Collapse){d.cleanupCellModifications(this)}var t=this.getTable();var a=d.getInfoOfFocusedCell(this);var i;if(!a||!a.cell){return}if(a.isOfType(s.DATACELL)){i=c.ELEMENTTYPES.DATACELL}else if(a.isOfType(s.COLUMNHEADER)){i=c.ELEMENTTYPES.COLUMNHEADER}else if(a.isOfType(s.ROWHEADER)){i=c.ELEMENTTYPES.ROWHEADER}else if(a.isOfType(s.ROWACTION)){i=c.ELEMENTTYPES.ROWACTION}else if(a.isOfType(s.COLUMNROWHEADER)){i=c.ELEMENTTYPES.COLUMNROWHEADER}if(!d["modifyAccOf"+i]){return}if(e!=="Focus"&&e!==r.RowsUpdateReason.Expand&&e!==r.RowsUpdateReason.Collapse){if(a.isOfType(s.DATACELL|s.ROWHEADER)){if(t._mTimeouts._cleanupACCCellBusy){clearTimeout(t._mTimeouts._cleanupACCCellBusy);t._mTimeouts._cleanupACCCellBusy=null}t._mTimeouts._cleanupACCCellBusy=setTimeout(function(){for(var e=0;e<this._busyCells.length;e++){this._busyCells[e].removeAttr("aria-hidden");this._busyCells[e].removeAttr("aria-busy")}t._mTimeouts._cleanupACCCellBusy=null;this._busyCells=[]}.bind(this),100);if(l.browser.chrome){a.cell.attr("aria-hidden","true")}a.cell.attr("aria-busy","true");this._busyCells.push(a.cell)}else{return}}d["modifyAccOf"+i].apply(this,[a.cell])};c.prototype.updateAriaStateOfColumn=function(e){if(!this._accMode){return}var t=d.getAriaAttributesFor(this,c.ELEMENTTYPES.COLUMNHEADER,{headerId:e.getId(),column:e,index:this.getTable().indexOfColumn(e)});var a=d.getRelevantColumnHeaders(this.getTable(),e);for(var i=0;i<a.length;i++){var r=o(document.getElementById(a[i]));if(!r.attr("colspan")){r.attr({"aria-sort":t["aria-sort"]||null})}}};c.prototype.updateAriaStateOfRow=function(e,t,a){if(!this._accMode){return}if(!t){t=e.getDomRefs(true)}if(t.row){t.row.children("td").add(t.row).attr("aria-selected",a?"true":null);if(a&&t.rowSelectorText){var i=t.rowSelectorText.text();if(i){i=r.getResourceText("TBL_ROW_DESC_SELECTED")+" "+i}t.rowSelectorText.text(i)}}};c.prototype.updateAriaExpandAndLevelState=function(e,t,a,i,r,l,o,n,s){if(!this._accMode){return}var u=null,E=this.getTable(),f=[t,t.children(),a,i,i?i.children():null,r],g=!!s,T=E.getBinding("rows");if(!l&&a&&!g){var p=a.attr("data-sap-ui-rowindex");var b=d.getAriaAttributesFor(this,c.ELEMENTTYPES.ROWHEADER,{rowSelected:!e._bHidden&&E.isIndexSelected(p)});u=b["title"]||null}if(a&&!g){a.attr({"aria-haspopup":l?"true":null,title:u})}if(T&&T.hasTotaledMeasures&&n>0&&(!T.bProvideGrandTotals||!T.hasTotaledMeasures())){n=n-1}for(var h=0;h<f.length;h++){if(f[h]){f[h].attr({"aria-expanded":l?o+"":null,"aria-level":n<0?null:n+1})}}if(g){s.attr(d.getAriaAttributesFor(this,c.ELEMENTTYPES.TREEICON,{row:e}))}};c.prototype.updateAriaStateOfRowHighlight=function(e){if(!this._accMode||!e){return}var t=e._getRow();var a=t?t.getDomRef("highlighttext"):null;if(a){a.innerText=e._getHighlightText()}};c.prototype.updateAriaStateForOverlayAndNoData=function(){var e=this.getTable();if(!e||!e.getDomRef()||!this._accMode){return}if(e.getShowOverlay()){e.$().find("[data-sap-ui-table-acc-covered*='overlay']").attr("aria-hidden","true")}else{e.$().find("[data-sap-ui-table-acc-covered*='overlay']").removeAttr("aria-hidden");if(r.isNoDataVisible(e)){e.$().find("[data-sap-ui-table-acc-covered*='nodata']").attr("aria-hidden","true")}else{e.$().find("[data-sap-ui-table-acc-covered*='nodata']").removeAttr("aria-hidden")}}};c.prototype.getAriaTextsForSelectionMode=function(e,t){var a=this.getTable();if(!t){t=a.getSelectionMode()}var i=a._getShowStandardTooltips();var l={mouse:{rowSelect:"",rowDeselect:""},keyboard:{rowSelect:"",rowDeselect:""}};var o=a._getSelectedIndicesCount();if(t===n.Single){l.mouse.rowSelect=i?r.getResourceText("TBL_ROW_SELECT"):"";l.mouse.rowDeselect=i?r.getResourceText("TBL_ROW_DESELECT"):"";l.keyboard.rowSelect=r.getResourceText("TBL_ROW_SELECT_KEY");l.keyboard.rowDeselect=r.getResourceText("TBL_ROW_DESELECT_KEY")}else if(t===n.MultiToggle){l.mouse.rowSelect=i?r.getResourceText("TBL_ROW_SELECT_MULTI_TOGGLE"):"";l.mouse.rowDeselect=i?r.getResourceText("TBL_ROW_DESELECT"):"";l.keyboard.rowSelect=r.getResourceText("TBL_ROW_SELECT_KEY");l.keyboard.rowDeselect=r.getResourceText("TBL_ROW_DESELECT_KEY");if(e===true&&o===0){l.mouse.rowSelect=i?r.getResourceText("TBL_ROW_SELECT"):""}}return l};c.prototype.setSelectAllState=function(e){var t=this.getTable();if(t){t.$("selall").attr("aria-pressed",e?"true":"false")}};c.prototype.addColumnHeaderLabel=function(e,t){var a=this.getTable();if(!this._accMode||!t.getAriaLabelledBy||!a){return}var i=a.getColumnHeaderVisible()?e.getId():null;if(!i){var r=e.getAggregation("label");if(r){i=r.getId()}}var l=t.getAriaLabelledBy();if(i&&l.indexOf(i)<0){t.addAriaLabelledBy(i)}};return c});