/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/model/Context","./TableUtils","sap/ui/thirdparty/jquery"],function(e,t,o,i){"use strict";var r=e.extend("sap.ui.table.Row",{metadata:{library:"sap.ui.table",defaultAggregation:"cells",aggregations:{cells:{type:"sap.ui.core.Control",multiple:true,singularName:"cell"},_rowAction:{type:"sap.ui.table.RowAction",multiple:false,visibility:"hidden"},_settings:{type:"sap.ui.table.RowSettings",multiple:false,visibility:"hidden"}}}});r.prototype.init=function(){this.initDomRefs()};r.prototype.exit=function(){this.initDomRefs()};r.prototype.getFocusInfo=function(){var t=this.getParent();return t?t.getFocusInfo():e.prototype.getFocusInfo.apply(this,arguments)};r.prototype.applyFocusInfo=function(t){var o=this.getParent();if(o){o.applyFocusInfo(t)}else{e.prototype.applyFocusInfo.apply(this,arguments)}return this};r.prototype.addStyleClass=function(e){this.getDomRefs(true).row.addClass(e)};r.prototype.removeStyleClass=function(e){this.getDomRefs(true).row.removeClass(e)};r.prototype.initDomRefs=function(){this._mDomRefs={}};r.prototype.getIndex=function(){var e=this.getParent();if(e){var t=e.indexOfRow(this);var o=e.getFixedRowCount();if(o>0&&t<o){return t}var i=e.getFixedBottomRowCount();var r=e.getVisibleRowCount();if(i>0&&t>=r-i){var n=e._getTotalRowCount();if(n>=r){return n-(r-t)}else{return t}}return e._getFirstRenderedRowIndex()+t}return-1};r.prototype.getDomRefs=function(e,t){var o=function(e){return i(document.getElementById(e))};var r=function(e){return e?window.document.getElementById(e):null};var n=e===true?"jQuery":"dom",a=e===true?o:r,s=this._mDomRefs;if(!s[n]){s[n]={};var l=this.getParent();if(l){var d=l.indexOfRow(this);s[n].rowSelector=a(l.getId()+"-rowsel"+d);s[n].rowAction=a(l.getId()+"-rowact"+d)}s[n].rowScrollPart=a(this.getId());s[n].rowFixedPart=a(this.getId()+"-fixed");s[n].rowSelectorText=a(this.getId()+"-rowselecttext");if(e===true){s[n].row=s[n].rowScrollPart;if(s[n].rowFixedPart.length>0){s[n].row=s[n].row.add(s[n].rowFixedPart)}else{s[n].rowFixedPart=undefined}if(s[n].rowSelector&&s[n].rowSelector.length>0){s[n].row=s[n].row.add(s[n].rowSelector)}else{s[n].rowSelector=undefined}if(s[n].rowAction&&s[n].rowAction.length>0){s[n].row=s[n].row.add(s[n].rowAction)}else{s[n].rowAction=undefined}}}var p=s[n];if(t){return Object.keys(p).map(function(e){return p[e]}).filter(Boolean)}return p};r.prototype._updateSelection=function(e,t,i){var r=e.isIndexSelected(this.getIndex());var n=this.getDomRefs(true);var a="rowSelect";if(r){a="rowDeselect"}if(n.rowSelector){n.rowSelector.attr("title",!this._bHidden?t.mouse[a]:"")}if(n.rowSelectorText){var s="";if(!this._bHidden&&!o.Grouping.isInSumRow(n.rowSelector)&&!o.Grouping.isInGroupingRow(n.rowSelector)){s=t.keyboard[a]}n.rowSelectorText.text(s)}var l=n.rowScrollPart;if(n.rowFixedPart){l=l.add(n.rowFixedPart)}if(i&&!this._bHidden){l.attr("title",t.mouse[a])}else{l.removeAttr("title")}if(n.row){this._setSelected(r);e._getAccExtension().updateAriaStateOfRow(this,n,r)}};r.prototype.setRowBindingContext=function(e,o,i){var r;if(e&&!(e instanceof t)){r=e;e=e.context}var n=this.getDomRefs(true).row;this._bHidden=!e;n.toggleClass("sapUiTableRowHidden",this._bHidden);this._collectRenderingInformation(e,r,i);this.setBindingContext(e,o)};r.prototype.setBindingContext=function(t,o){var i=e.prototype.setBindingContext.call(this,t||null,o);this._updateTableCells(t);return i};r.prototype._updateTableCells=function(e){var t=this.getParent();if(!t){return}var o=this.getCells(),i=this.getIndex(),r=!!t._updateTableCell,n,a,s;for(var l=0;l<o.length;l++){n=o[l];s=!!n._updateTableCell;a=s||r?n.$().closest("td"):null;if(s){n._updateTableCell(n,e,a,i)}if(r){t._updateTableCell(n,e,a,i)}}};r.prototype._collectRenderingInformation=function(e,t,o){this._oNodeState=undefined;this._iLevel=0;this._bIsExpanded=false;this._bHasChildren=false;this._sTreeIconClass="";if(t){this._oNodeState=t.nodeState;this._iLevel=t.level;this._bIsExpanded=false;this._bHasChildren=false;this._sTreeIconClass="sapUiTableTreeIconLeaf";this._sGroupIconClass="";if(o){if(o.getLevel){this._bIsExpanded=o.isExpanded(this.getIndex())}else if(o.findNode){this._bIsExpanded=this&&this._oNodeState?this._oNodeState.expanded:false}if(o.nodeHasChildren){if(this._oNodeState){this._bHasChildren=o.nodeHasChildren(t)}}else if(o.hasChildren){this._bHasChildren=o.hasChildren(e)}if(this._bHasChildren){this._sTreeIconClass=this._bIsExpanded?"sapUiTableTreeIconNodeOpen":"sapUiTableTreeIconNodeClosed";this._sGroupIconClass=this._bIsExpanded?"sapUiTableGroupIconOpen":"sapUiTableGroupIconClosed"}}}};r.prototype.destroy=function(){this.removeAllCells();return e.prototype.destroy.apply(this,arguments)};r.prototype.invalidate=function(){return this};r.prototype.getDragGhost=function(){var e=this.getParent();var t=e.getDomRef();var o=this.getDomRefs();var i;var r;var n;var a=e._getSelectedIndicesCount();function s(e){e.removeAttribute("id");e.removeAttribute("data-sap-ui");e.removeAttribute("data-sap-ui-related");var t=e.children.length;for(var o=0;o<t;o++){s(e.children[o])}}function l(e,t){var o=e.cloneNode();var i=e.querySelector("thead").cloneNode(true);var r=e.querySelector("tbody").cloneNode();var n=t.cloneNode(true);r.appendChild(n);o.appendChild(i);o.appendChild(r);return o}i=t.cloneNode();i.classList.add("sapUiTableRowGhost");i.classList.remove("sapUiTableVScr");i.classList.remove("sapUiTableHScr");i.style.width=t.getBoundingClientRect().width+"px";if(o.rowSelector){r=e.getDomRef("sapUiTableRowHdrScr").cloneNode();n=o.rowSelector.cloneNode(true);r.appendChild(n);i.appendChild(r)}if(o.rowFixedPart){r=e.getDomRef("sapUiTableCtrlScrFixed").cloneNode();n=l(e.getDomRef("table-fixed"),o.rowFixedPart);r.appendChild(n);i.appendChild(r)}if(o.rowScrollPart){var d=e.getDomRef("sapUiTableCtrlScr");r=d.cloneNode();n=l(e.getDomRef("table"),o.rowScrollPart);r.appendChild(e.getDomRef("tableCtrlCnt").cloneNode());r.firstChild.appendChild(n);i.appendChild(r)}if(o.rowAction){r=e.getDomRef("sapUiTableRowActionScr").cloneNode();n=o.rowAction.cloneNode(true);r.appendChild(n);i.appendChild(r)}if(a>1){r=document.createElement("div");r.classList.add("sapUiTableRowGhostCount");var p=document.createElement("div");p.textContent=a;r.appendChild(p);i.appendChild(r)}s(i);return i};r.prototype._setSelected=function(e){var t=this.getParent();if(e){this.addStyleClass("sapUiTableRowSel")}else{this.removeStyleClass("sapUiTableRowSel")}if(t){o.dynamicCall(t._getSyncExtension,function(o){o.syncRowSelection(t.indexOfRow(this),e)},this)}};r.prototype._setHovered=function(e){var t=this.getParent();if(e){this.addStyleClass("sapUiTableRowHvr")}else{this.removeStyleClass("sapUiTableRowHvr")}if(t){o.dynamicCall(t._getSyncExtension,function(o){o.syncRowHover(t.indexOfRow(this),e)},this)}};return r});