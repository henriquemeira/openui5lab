/*
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/SelectionModel","./SelectionAdapter","./library"],function(e,t,o){"use strict";var i=o.SelectionMode;var n=t.extend("sap.ui.table.SelectionModelAdapter");n.prototype.init=function(){this.oSelectionModel=new e(this.getSelectionMode);this.oSelectionModel.attachEvent("selectionChanged",this._onSelectionChange,this);t.prototype.init.call(this)};n.prototype.exit=function(){var e=this._getBinding();if(e){e.detachEvent("change",this._onBindingChange)}if(this.oSelectionModel){this.oSelectionModel.destroy();this.oSelectionModel=null}t.prototype.exit.call(this)};n.prototype.addSelectionInterval=function(e,t){if(!this.oSelectionModel||this.getSelectionMode()===i.None){return}this.oSelectionModel.addSelectionInterval(e,t)};n.prototype.clearSelection=function(){if(this.oSelectionModel){this.oSelectionModel.clearSelection()}};n.prototype.getSelectedIndex=function(){if(this.oSelectionModel){return this.oSelectionModel.getLeadSelectedIndex()}return-1};n.prototype.getSelectedIndices=function(){if(this.oSelectionModel){return this.oSelectionModel.getSelectedIndices()}return[]};n.prototype.getSelectableCount=function(){var e=this._getBinding();return e?e.getLength():0};n.prototype.getSelectedCount=function(){return this.getSelectedIndices().length};n.prototype.isIndexSelectable=function(e){var t=this._getLastIndex();return e>=0&&e<=t};n.prototype.isIndexSelected=function(e){return this.getSelectedIndices().indexOf(e)!==-1};n.prototype.removeSelectionInterval=function(e,t){if(this.oSelectionModel){this.oSelectionModel.removeSelectionInterval(e,t)}};n.prototype.selectAll=function(){if(!this.oSelectionModel||this.getSelectionMode()===i.None){return}this.oSelectionModel.selectAll(this._getLastIndex())};n.prototype.setSelectedIndex=function(e){if(this.getSelectionMode()===i.None){return}if(e===-1){this.clearSelection()}else{this.setSelectionInterval(e,e)}};n.prototype.setSelectionInterval=function(e,t){if(!this.oSelectionModel||this.getSelectionMode()===i.None){return}this.oSelectionModel.setSelectionInterval(e,t)};n.prototype.setSelectionMode=function(o){var n=this.getSelectionMode();t.prototype.setSelectionMode.apply(this,arguments);if(this.getSelectionMode()!==n){this.clearSelection()}if(this.oSelectionModel){var l=o===i.MultiToggle?e.MULTI_SELECTION:e.SINGLE_SELECTION;this.oSelectionModel.setSelectionMode(l)}return this};n.prototype._getLastIndex=function(){if(!this._getBinding()){return 0}return this._getBinding().getLength()-1};n.prototype._onSelectionChange=function(e){var t=e.getParameter("rowIndices");var o=e.getParameter("selectAll");this.fireSelectionChange({rowIndices:t,selectAll:o})};n.prototype._setBinding=function(e){var o=this._getBinding();t.prototype._setBinding.call(this,e);if(o!==e){this._suspend();this.clearSelection();this._resume();if(e){e.attachEvent("change",this._onBindingChange,this)}if(o){o.detachEvent("change",this._onBindingChange)}}};n.prototype._onBindingChange=function(e){var t=typeof e==="object"?e.getParameter("reason"):e;if(t==="sort"||t==="filter"){this.clearSelection()}};return n});