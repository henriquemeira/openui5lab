/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/Device","sap/ui/core/Control","sap/ui/core/Element","sap/ui/core/IconPool","sap/ui/core/util/PasteHelper","sap/ui/model/ChangeReason","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/BindingMode","./Column","./Row","./library","./TableUtils","./TableExtension","./TableAccExtension","./TableKeyboardExtension","./TablePointerExtension","./TableScrollExtension","./TableDragAndDropExtension","./TableRenderer","./SelectionModelAdapter","sap/ui/thirdparty/jquery","sap/base/Log"],function(e,t,i,o,n,r,s,a,l,u,h,d,p,g,c,f,w,R,b,v,m,y,_){"use strict";var C=d.GroupEventType,x=d.NavigationMode,S=d.SelectionMode,T=d.SelectionBehavior,A=d.SortOrder,I=d.VisibleRowCountMode;var B=20;var F=t.extend("sap.ui.table.Table",{metadata:{library:"sap.ui.table",dnd:true,properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"auto"},rowHeight:{type:"int",group:"Appearance",defaultValue:null},columnHeaderHeight:{type:"int",group:"Appearance",defaultValue:null},columnHeaderVisible:{type:"boolean",group:"Appearance",defaultValue:true},visibleRowCount:{type:"int",group:"Appearance",defaultValue:10},firstVisibleRow:{type:"int",group:"Appearance",defaultValue:0},selectionMode:{type:"sap.ui.table.SelectionMode",group:"Behavior",defaultValue:S.MultiToggle},selectionBehavior:{type:"sap.ui.table.SelectionBehavior",group:"Behavior",defaultValue:T.RowSelector},selectedIndex:{type:"int",group:"Appearance",defaultValue:-1},editable:{type:"boolean",group:"Behavior",defaultValue:true},navigationMode:{type:"sap.ui.table.NavigationMode",group:"Behavior",defaultValue:x.Scrollbar,deprecated:true},threshold:{type:"int",group:"Appearance",defaultValue:100},enableColumnReordering:{type:"boolean",group:"Behavior",defaultValue:true},enableGrouping:{type:"boolean",group:"Behavior",defaultValue:false},showColumnVisibilityMenu:{type:"boolean",group:"Appearance",defaultValue:false},showNoData:{type:"boolean",group:"Appearance",defaultValue:true},visibleRowCountMode:{type:"sap.ui.table.VisibleRowCountMode",group:"Appearance",defaultValue:I.Fixed},minAutoRowCount:{type:"int",group:"Appearance",defaultValue:5},fixedColumnCount:{type:"int",group:"Appearance",defaultValue:0},fixedRowCount:{type:"int",group:"Appearance",defaultValue:0},fixedBottomRowCount:{type:"int",group:"Appearance",defaultValue:0},enableColumnFreeze:{type:"boolean",group:"Behavior",defaultValue:false},enableCellFilter:{type:"boolean",group:"Behavior",defaultValue:false},showOverlay:{type:"boolean",group:"Appearance",defaultValue:false},enableSelectAll:{type:"boolean",group:"Behavior",defaultValue:true},enableCustomFilter:{type:"boolean",group:"Behavior",defaultValue:false},enableBusyIndicator:{type:"boolean",group:"Behavior",defaultValue:false},rowActionCount:{type:"int",group:"Appearance",defaultValue:0},alternateRowColors:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"columns",aggregations:{title:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},footer:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},toolbar:{type:"sap.ui.core.Toolbar",multiple:false,deprecated:true},extension:{type:"sap.ui.core.Control",multiple:true,singularName:"extension"},columns:{type:"sap.ui.table.Column",multiple:true,singularName:"column",bindable:"bindable"},rows:{type:"sap.ui.table.Row",multiple:true,singularName:"row",bindable:"bindable",selector:"#{id}-tableCCnt",dnd:true},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},rowActionTemplate:{type:"sap.ui.table.RowAction",multiple:false},rowSettingsTemplate:{type:"sap.ui.table.RowSettings",multiple:false},contextMenu:{type:"sap.ui.core.IContextMenu",multiple:false}},associations:{groupBy:{type:"sap.ui.table.Column",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{rowSelectionChange:{parameters:{rowIndex:{type:"int"},rowContext:{type:"object"},rowIndices:{type:"int[]"},selectAll:{type:"boolean"},userInteraction:{type:"boolean"}}},columnSelect:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"}}},columnResize:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"},width:{type:"sap.ui.core.CSSSize"}}},columnMove:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"},newPos:{type:"int"}}},sort:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"},sortOrder:{type:"sap.ui.table.SortOrder"},columnAdded:{type:"boolean"}}},filter:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"},value:{type:"string"}}},group:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"}}},columnVisibility:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"},newVisible:{type:"boolean"}}},cellClick:{allowPreventDefault:true,parameters:{cellControl:{type:"sap.ui.core.Control"},cellDomRef:{type:"Object"},rowIndex:{type:"int"},columnIndex:{type:"int"},columnId:{type:"string"},rowBindingContext:{type:"sap.ui.model.Context"}}},cellContextmenu:{allowPreventDefault:true,parameters:{cellControl:{type:"sap.ui.core.Control"},cellDomRef:{type:"Object"},rowIndex:{type:"int"},columnIndex:{type:"int"},columnId:{type:"string"},rowBindingContext:{type:"sap.ui.model.Context"}},deprecated:true},beforeOpenContextMenu:{allowPreventDefault:true,parameters:{rowIndex:{type:"int"},columnIndex:{type:"int"},contextMenu:{type:"sap.ui.core.IContextMenu"}}},columnFreeze:{allowPreventDefault:true,parameters:{column:{type:"sap.ui.table.Column"}}},customFilter:{column:{type:"sap.ui.table.Column"},value:{type:"string"}},firstVisibleRowChanged:{firstVisibleRow:{type:"int"}},busyStateChanged:{busy:{type:"boolean"}},paste:{allowPreventDefault:true,parameters:{data:{type:"string[][]"}}}},designtime:"sap/ui/table/designtime/Table.designtime"}});o.insertFontFaceStyle();F.prototype.init=function(){this._iBaseFontSize=parseFloat(y("body").css("font-size"))||16;this._bRtlMode=sap.ui.getCore().getConfiguration().getRTL();this._bIsFlexItem=false;this._attachExtensions();this._initSelectionAdapter();this._bRowsBeingBound=false;this._bContextsRequested=false;this._bContextsAvailable=false;this._aRowClones=[];this._bRowAggregationInvalid=true;this._mTimeouts={};this._mAnimationFrames={};this._bHideStandardTooltips=false;this._aRowHeights=[];this._iRenderedFirstVisibleRow=0;this._aSortedColumns=[];this._performUpdateRows=p.throttle(function(e){this._updateBindingContexts();if(this._bInvalid){return}this._getAccExtension().updateAccForCurrentCell(e);this._updateTableContent();this._updateSelection();this._aRowHeights=this._collectRowHeights(false);this._updateRowHeights(this._collectRowHeights(true),true);this._updateRowHeights(this._aRowHeights,false);this._iRenderedFirstVisibleRow=this._getFirstRenderedRowIndex();this._getScrollExtension().updateVerticalScrollbarVisibility();this._fireRowsUpdated(e)},{wait:50,asyncLeading:true});this._aTableHeaders=[];this._bAllowColumnHeaderTextSelection=false;this._iPendingRequests=0;this._bPendingRequest=false;this._iBindingLength=null;this._iTableRowContentHeight=0;this._bFirstRendering=true;this._nDevicePixelRatio=window.devicePixelRatio;this._bInvalid=true};F.prototype._initSelectionAdapter=function(){this._oSelectionAdapter=new m;this._oSelectionAdapter.attachEvent("selectionChange",this._onSelectionChanged,this)};F.prototype._attachExtensions=function(){if(this._bExtensionsInitialized){return}g.enrich(this,w);g.enrich(this,R);g.enrich(this,f);g.enrich(this,c);g.enrich(this,b);this._bExtensionsInitialized=true};F.prototype.exit=function(){this.invalidateRowsAggregation();this._detachExtensions();if(this._dataReceivedHandlerId){clearTimeout(this._dataReceivedHandlerId);delete this._dataReceivedHandlerId}this._cleanUpTimers();this._detachEvents();if(this._oSelectionAdapter){this._oSelectionAdapter.destroy()}delete this._aTableHeaders};F.prototype._detachExtensions=function(){g.cleanup(this)};F.prototype.onpaste=function(e){if(e.isMarked()||/^(input|textarea)$/i.test(e.target.tagName)||!this.getDomRef("sapUiTableCnt").contains(e.target)){return}var t=n.getPastedDataAs2DArray(e.originalEvent);if(t.length===0||t[0].length===0){return}this.firePaste({data:t})};F.prototype.onThemeChanged=function(){if(this.getDomRef()){this.invalidate()}};F.prototype.onlocalizationChanged=function(e){var t=e.changes||{};var i=t.hasOwnProperty("rtl");var o=t.hasOwnProperty("language");this._adaptLocalization(i,o).then(function(){this.invalidate()}.bind(this))};F.prototype._adaptLocalization=function(e,t){if(!e&&!t){return Promise.reject()}var i=Promise.resolve();if(e){this._bRtlMode=sap.ui.getCore().getConfiguration().getRTL()}if(t){i=p.getResourceBundle({async:true,reload:true})}return i.then(function(){if(t){p.Menu.cleanupDataCellContextMenu(this);this._invalidateColumnMenus()}}.bind(this))};F.prototype._collectRowHeights=function(t){var i=this.getDomRef();if(!i){return[]}var o=this._getDefaultRowHeight();var n=t?".sapUiTableColHdrTr":".sapUiTableTr";var r=i.querySelectorAll(".sapUiTableCtrlFixed > tbody > tr"+n);var s=i.querySelectorAll(".sapUiTableCtrlScroll > tbody > tr"+n);var a=this.getRows().length;var l=[];var u=e.browser.chrome&&window.devicePixelRatio!=1;if(t&&this.getColumnHeaderHeight()>0){o=this.getColumnHeaderHeight()}for(var h=0;h<a;h++){var d=r[h]?r[h].getBoundingClientRect().height:0;var g=s[h]?s[h].getBoundingClientRect().height:0;var c=Math.max(d,g);if(u){var f=o-c;if(f>0&&f<1){l.push(Math.max(c,o-1));continue}}l.push(Math.max(c,o))}if(l.length>0&&!t){p.dynamicCall(this._getSyncExtension,function(e){var t=e.syncRowHeights(l.slice());if(t&&t.length===l.length){l=t.slice()}})}return l};F.prototype._resetRowHeights=function(){var e=this._getDefaultRowHeight();var t="";if(e){t=e+"px"}var i=this.getDomRef();if(i){var o=i.querySelectorAll(".sapUiTableTr");for(var n=0;n<o.length;n++){o[n].style.height=t}}};F.prototype._resetColumnHeaderHeights=function(){var e=this.getDomRef();if(e){var t=e.querySelectorAll(".sapUiTableColHdrTr");for(var i=0;i<t.length;i++){t[i].style.height=null}}};F.prototype._determineAvailableSpace=function(){var t=this.getDomRef();if(t&&t.parentNode){var i=t.querySelector(".sapUiTableCCnt");if(i){var o=0;if(this._bIsFlexItem){var n=t.childNodes;for(var r=0;r<n.length;r++){o+=n[r].offsetHeight}o-=i.clientHeight}else{o=t.scrollHeight-i.clientHeight}var s=this._getScrollExtension();if(!s.isHorizontalScrollbarVisible()){var a={};a[e.browser.BROWSER.CHROME]=16;a[e.browser.BROWSER.FIREFOX]=16;a[e.browser.BROWSER.INTERNET_EXPLORER]=18;a[e.browser.BROWSER.EDGE]=16;a[e.browser.BROWSER.SAFARI]=16;a[e.browser.BROWSER.ANDROID]=8;o+=a[e.browser.name]}if(this._iLastAvailableSpace==null){this._iLastAvailableSpace=0}var l=this._bIsFlexItem?t:t.parentNode;var u=Math.floor(y(l).height()-o);var h=Math.abs(u-this._iLastAvailableSpace);if(h>=5){this._iLastAvailableSpace=u}return this._iLastAvailableSpace}}return 0};F.prototype._collectTableSizes=function(){var e={tableCtrlScrollWidth:0,tableRowHdrScrWidth:0,tableCtrlScrWidth:0,tableHSbScrollLeft:0,tableCtrlFixedWidth:0,tableCntHeight:0,tableCntWidth:0};var t=this.getDomRef();if(!t){return e}var i=t.querySelector(".sapUiTableCnt");if(i){e.tableCntHeight=i.clientHeight;e.tableCntWidth=i.clientWidth}var o=t.querySelector(".sapUiTableCtrlScroll:not(.sapUiTableCHT)");if(o){e.tableCtrlScrollWidth=o.clientWidth}var n=t.querySelector(".sapUiTableRowHdrScr");if(n){e.tableRowHdrScrWidth=n.clientWidth}var r=t.querySelector(".sapUiTableCtrlScr:not(.sapUiTableCHA)");if(r){e.tableCtrlScrWidth=r.clientWidth}var s=this._getScrollExtension().getHorizontalScrollbar();if(s){e.tableHSbScrollLeft=s.scrollLeft}var a=t.querySelector(".sapUiTableCtrlScrFixed:not(.sapUiTableCHA) > .sapUiTableCtrlFixed");if(a){e.tableCtrlFixedWidth=a.clientWidth}var l=this.getFixedColumnCount();var u=0;if(l){var h=this.getColumns();var d=t.querySelectorAll(".sapUiTableCtrlFirstCol:not(.sapUiTableCHTHR) > th");for(var g=0;g<d.length;g++){var c=parseInt(d[g].getAttribute("data-sap-ui-headcolindex"));if(!isNaN(c)&&c<l){var f=h[c];var w;if(f._iFixWidth!=null){w=f._iFixWidth}else{w=d[g].getBoundingClientRect().width}u+=w}}}if(u>0){var R=this._getScrollExtension();var b=e.tableRowHdrScrWidth;var v=R.getVerticalScrollbar();if(v&&!R.isVerticalScrollbarExternal()){b+=v.offsetWidth}if(p.hasRowActions(this)){var m=this.getDomRef("sapUiTableRowActionScr");if(m){b+=m.offsetWidth}}b+=p.Column.getMinColumnWidth();var y=e.tableCntWidth-b;var _=y>u;var C=!_;if(this._bIgnoreFixedColumnCount!==C){this._bIgnoreFixedColumnCount=C;if(this.getEnableColumnFreeze()){this._invalidateColumnMenus()}this.invalidate()}}return e};F.prototype._updateRowHeights=function(e,t){var i=this.getDomRef();if(!i){return}function o(t,i){var o=e[i];if(o){t.style.height=o+"px"}}var n=t?".sapUiTableColHdrTr":".sapUiTableTr";var r=t?[]:i.querySelectorAll(".sapUiTableRowHdr");var s=t?[]:i.querySelectorAll(".sapUiTableRowAction");var a=i.querySelectorAll(".sapUiTableCtrlFixed > tbody > tr"+n);var l=i.querySelectorAll(".sapUiTableCtrlScroll > tbody > tr"+n);Array.prototype.forEach.call(r,o);Array.prototype.forEach.call(s,o);Array.prototype.forEach.call(a,o);Array.prototype.forEach.call(l,o)};F.prototype.onBeforeRendering=function(e){if(e&&e.isMarked("renderRows")){return}if(this._performUpdateRows.pending()){this._updateBindingContexts()}this._cleanUpTimers();this._detachEvents();var t=this.getVisibleRowCountMode();var i=this.getRows();this.getBinding("rows");if(t==I.Interactive||t==I.Fixed||t==I.Auto&&this._iTableRowContentHeight&&i.length==0){this._updateRows(this._calculateRowsToDisplay(),p.RowsUpdateReason.Render)}else if(this._bRowAggregationInvalid&&i.length>0){this._updateRows(this.getVisibleRowCount(),p.RowsUpdateReason.Render)}this._aTableHeaders=[]};F.prototype.onAfterRendering=function(e){var t=e&&e.isMarked("renderRows");var i=this.getVisibleRowCountMode();var o=this.getVisibleRowCount();var n=this.$();this._bInvalid=false;this._attachEvents();this._initRowDomRefs();var r=this.getColumns();for(var s=0,a=r.length;s<a;s++){if(r[s].getVisible()){r[s]._restoreIcons()}}if(!this._bAllowColumnHeaderTextSelection&&!t){this._disableTextSelection(n.find(".sapUiTableColHdrCnt"))}this._getKeyboardExtension().invalidateItemNavigation();this._updateTableContent();this.getDomRef().classList.remove("sapUiTableRActFlexible");if(!t){this._aTableHeaders=this.$().find(".sapUiTableColHdrCnt th")}if(this._bFirstRendering&&i===I.Auto){Promise.resolve().then(this._updateTableSizes.bind(this,p.RowsUpdateReason.Render,{forceUpdate:true}))}else{var l={skipHandleRowCountMode:t};var u=function(){if(t||this.getBinding("rows")==null){return}if(i===I.Auto){if(o===this.getVisibleRowCount()){this._fireRowsUpdated(p.RowsUpdateReason.Render)}}else{this._fireRowsUpdated(p.RowsUpdateReason.Render)}}.bind(this);if(t){if(p.isVariableRowHeightEnabled(this)){l.rowContentHeight="reset"}else if(this.getRows().length===0&&i!==I.Interactive){l.rowContentHeight="recalculate"}}if(!t&&i===I.Auto&&this._bIsFlexItem){Promise.resolve().then(this._updateTableSizes.bind(this,p.RowsUpdateReason.Render,l)).then(u)}else{this._updateTableSizes(p.RowsUpdateReason.Render,l);u()}}this._bFirstRendering=false};F.prototype.invalidate=function(){this._bInvalid=true;p.Column.invalidateColumnUtils(this);return t.prototype.invalidate.call(this)};F.prototype._initRowDomRefs=function(){var e=this.getRows();for(var t=0;t<e.length;t++){e[t].initDomRefs()}};F.prototype._updateTableSizes=function(e,t){var i=this.getDomRef();var o=this;function n(){p.registerResizeHandler(o,"",o._onTableResize.bind(o),!o._bIsFlexItem)}function r(){p.deregisterResizeHandler(o,"")}if(this._bInvalid||!i||!sap.ui.getCore().isThemeApplied()){return}t=Object.assign({forceUpdate:false,skipHandleRowCountMode:false,rowContentHeight:undefined},t);this._bIsFlexItem=window.getComputedStyle(i.parentNode).display==="flex";if(i.offsetWidth===0){n();return}this._resetRowHeights();this._resetColumnHeaderHeights();this._aRowHeights=this._collectRowHeights(false);var s=this._collectRowHeights(true);if(p.isVariableRowHeightEnabled(this)&&!p.isNoDataVisible(this)){this._getScrollExtension().updateInnerVerticalScrollPosition()}var a=null;if(!t.skipHandleRowCountMode&&this.getVisibleRowCountMode()==I.Auto){a=this._determineAvailableSpace();var l=this._calculateRowsToDisplay(a);if(this._updateRows(l,e)&&!t.forceUpdate){return}}if(!this._bIsFlexItem){r()}function u(e){var t=e.getDomRef();var i=p.Column.getMinColumnWidth();var o=[];var n=e.getColumnHeaderVisible();function r(e,t){if(e<=t){return Math.max(e,t-5,i)+"px"}return-1}function s(s){var a=Math.max(s._minWidth||0,i,s.getMinWidth());var l=s.getWidth();var u;var h;var d;if(p.isVariableWidth(l)&&!p.isFixedColumn(e,s.getIndex())){u=t.querySelectorAll('th[data-sap-ui-colid="'+s.getId()+'"]');h=u[n?0:1];d=h?h.offsetWidth:null;if(d!==null){if(d<=a){return{headers:u,newWidth:r(d,a)}}else if(h&&h.style.width!=l){o.push({col:s,header:h,minWidth:a,headers:u});return{headers:u,newWidth:l}}o.push({col:s,header:h,minWidth:a,headers:u})}}return null}function a(e){if(e){Array.prototype.forEach.call(e.headers,function(t){t.style.width=e.newWidth})}}e._getVisibleColumns().map(s).forEach(a);if(o.length){var l;for(var u=0;u<o.length;u++){l=o[u].header&&o[u].header.offsetWidth;o[u].newWidth=r(l,o[u].minWidth);if(parseInt(o[u].newWidth)>=0){a(o[u])}}}}u(this);this._updateRowHeights(this._aRowHeights,false);this._updateRowHeights(s,true);if(!t.skipHandleRowCountMode||t.rowContentHeight==="reset"){this._setRowContentHeight(a)}else if(t.rowContentHeight==="recalculate"){this._setRowContentHeight(this._determineAvailableSpace())}if(this.getVisibleRowCountMode()==I.Auto){var h=this._calculateRowsToDisplay(a!=null?a:this._determineAvailableSpace());if(h==this._determineMinAutoRowCount()){this.$().height("auto")}else{this.$().height("0px")}}p.dynamicCall(this._getSyncExtension,function(e){e.syncLayout({top:this.getDomRef("sapUiTableCnt").offsetTop,headerHeight:this.getDomRef().querySelector(".sapUiTableColHdrCnt").getBoundingClientRect().height,contentHeight:this.getDomRef("tableCCnt").getBoundingClientRect().height})},this);var d=this._collectTableSizes();var g=this._getScrollExtension();g.updateHorizontalScrollbar(d);g.updateVerticalScrollbarPosition();g.updateVerticalScrollbarVisibility();var c=this.$();if(p.hasRowActions(this)){var f=c.hasClass("sapUiTableRActFlexible");var w=this.getDomRef("dummycolhdr");var R=w?w.clientWidth:0;if(!f&&R>0){var b=d.tableCtrlScrWidth+d.tableRowHdrScrWidth+d.tableCtrlFixedWidth-R;var v={width:"auto"};v[this._bRtlMode?"right":"left"]=b;this.$("sapUiTableRowActionScr").css(v);this.$("rowacthdr").css(v);c.toggleClass("sapUiTableRActFlexible",true)}else if(f&&R<=0){this.$("sapUiTableRowActionScr").removeAttr("style");this.$("rowacthdr").removeAttr("style");c.toggleClass("sapUiTableRActFlexible",false)}}c.find(".sapUiTableNoOpacity").addBack().removeClass("sapUiTableNoOpacity");if(this._bIsFlexItem){n()}else{Promise.resolve().then(function(){if(o.getVisibleRowCountMode()===I.Auto){var t=o._calculateRowsToDisplay(o._determineAvailableSpace());if(o.getVisibleRowCount()!==t){o._iRenderingLoopCount=o._iRenderingLoopCount?o._iRenderingLoopCount+1:1;if(o._iRenderingLoopCount>B){_.error("Rendering has been re-started too many times ("+o._iRenderingLoopCount+")."+" Please run the Support Assistant to detect possible configuration issues.",o);return}o._updateRows(t,e)}else{delete o._iRenderingLoopCount;n()}}else{n()}})}};F.prototype.setShowOverlay=function(e){e=!!e;this.setProperty("showOverlay",e,true);if(this.getDomRef()){var t=document.activeElement;this.$().toggleClass("sapUiTableOverlay",e);this._getAccExtension().updateAriaStateForOverlayAndNoData();this._getKeyboardExtension().updateNoDataAndOverlayFocus(t)}return this};F.prototype._updateFixedBottomRows=function(){var e=this.getFixedBottomRowCount();var t=this.getDomRef();if(t&&e>0){var i=y(t).find(".sapUiTableFixedPreBottomRow");i.removeClass("sapUiTableFixedPreBottomRow");var o=y(t).find(".sapUiTableFixedFirstBottomRow");o.removeClass("sapUiTableFixedFirstBottomRow");var n=p.getFirstFixedButtomRowIndex(this);var r=this.getRows();var s;if(n>=0&&n<r.length){s=r[n].getDomRefs(true);s.row.addClass("sapUiTableFixedFirstBottomRow",true)}if(n>=1&&n<r.length){s=r[n-1].getDomRefs(true);s.row.addClass("sapUiTableFixedPreBottomRow",true)}}};F.prototype.getFocusInfo=function(){var e=this.$().find(":focus").attr("id");if(e){return{customId:e}}else{return i.prototype.getFocusInfo.apply(this,arguments)}};F.prototype.applyFocusInfo=function(e){if(e&&e.customId){y(document.getElementById(e.customId)).focus()}else{i.prototype.getFocusInfo.apply(this,arguments)}return this};F.prototype.setTitle=function(e){var t=e;if(typeof e==="string"||e instanceof String){t=d.TableHelper.createTextView({text:e,width:"100%"});t.addStyleClass("sapUiTableHdrTitle")}this.setAggregation("title",t);return this};F.prototype.setFooter=function(e){var t=e;if(typeof e==="string"||e instanceof String){t=d.TableHelper.createTextView({text:e,width:"100%"})}this.setAggregation("footer",t);return this};F.prototype.setSelectionMode=function(e){if(e===S.Multi){e=S.MultiToggle;_.warning("The selection mode 'Multi' is deprecated and must not be used anymore."+" Your setting was defaulted to selection mode 'MultiToggle'")}this.setProperty("selectionMode",e);this._oSelectionAdapter.setSelectionMode(e);return this};F.prototype.setFirstVisibleRow=function(e,t,i){if(parseInt(e)<0){_.error("The index of the first visible row must be greater than or equal to 0."+" The value has been set to 0.",this);e=0}if(this._getTotalRowCount()>0){var o=this._getMaxFirstVisibleRowIndex();if(o<e){_.warning("The index of the first visible row must be lesser or equal than the scrollable row count minus the visible row count."+" The value has been set to "+o+".",this);e=o}}var n=this.getFirstVisibleRow()!=e;var r=this._getScrollExtension();if(n){var s=this._getFirstRenderedRowIndex();this.setProperty("firstVisibleRow",e,true);var a=this._getFirstRenderedRowIndex()!==s;if(this.getBinding("rows")){if(a){var l=t===true?p.RowsUpdateReason.VerticalScroll:p.RowsUpdateReason.FirstVisibleRowChange;this.updateRows(l)}if(!t){r.updateVerticalScrollPosition()}}if(!i){this.fireFirstVisibleRowChanged({firstVisibleRow:e})}}else if(!t){r.updateVerticalScrollPosition()}return this};F.getMetadata().getAggregation("rows")._doesNotRequireFactory=true;F.prototype.bindAggregation=function(e){if(e==="rows"){return this.bindRows.apply(this,[].slice.call(arguments,1))}return t.prototype.bindAggregation.apply(this,arguments)};F.prototype.bindRows=function(e){this._bRowsBeingBound=true;this._bContextsRequested=false;this._bContextsAvailable=false;if(this.getEnableBusyIndicator()){this.setBusy(false)}this._iPendingRequests=0;this._bPendingRequest=false;return t.prototype.bindAggregation.call(this,"rows",F._getSanitizedBindingInfo(arguments))};F.prototype._bindAggregation=function(e,t){if(e==="rows"){this._bRowsBeingBound=true;this._bContextsRequested=false;this._bContextsAvailable=false;F._addBindingListener(t,"change",this._onBindingChange.bind(this));F._addBindingListener(t,"dataRequested",this._onBindingDataRequested.bind(this));F._addBindingListener(t,"dataReceived",this._onBindingDataReceived.bind(this))}i.prototype._bindAggregation.call(this,e,t);if(e==="rows"){var o=this.getBinding("rows");var n=o?o.getModel():null;this._oSelectionAdapter._setBinding(o);if(n&&n.getDefaultBindingMode()===l.OneTime){_.error('The binding mode of the model is set to "OneTime".'+' This binding mode is not supported for the "rows" aggregation!'+" Scrolling can not be performed.",this)}this._bRowsBeingBound=false}};F.prototype.destroyAggregation=function(e,i){var o=t.prototype.destroyAggregation.apply(this,arguments);if(e==="rows"){this._aRowClones.forEach(function(e){e.destroy()});this._aRowClones=[]}return o};F._getSanitizedBindingInfo=function(e){var t;if(e==null||e[0]==null){t=null}else if(typeof e[0]==="string"){var i=e[0];var o=e[1];var n=e[2];var r=e[3];if(o instanceof a||Array.isArray(n)&&n[0]instanceof s){r=n;n=o;o=undefined}t={path:i,sorter:n,filters:r,template:o}}else{t=e[0]}return t};F._addBindingListener=function(e,t,i){if(!e.events){e.events={}}if(!e.events[t]){e.events[t]=i}else{var o=e.events[t];e.events[t]=function(){i.apply(this,arguments);o.apply(this,arguments)}}};F.prototype._onBindingChange=function(e){var t=typeof e==="object"?e.getParameter("reason"):e;if(t==="sort"||t==="filter"){this.setFirstVisibleRow(0)}};F.prototype.unbindAggregation=function(e,t){var o=this.getBinding("rows");if(e==="rows"&&this.isBound("rows")){t=true}var n=i.prototype.unbindAggregation.call(this,e,t);if(e==="rows"&&o){this._invalidateColumnMenus();if(!this._bRowsBeingBound){this._oSelectionAdapter._setBinding(null);this._adjustToTotalRowCount();this._updateRows(this.getVisibleRowCount(),p.RowsUpdateReason.Unbind);this.updateRows(p.RowsUpdateReason.Unbind)}}return n};F.prototype.setVisibleRowCount=function(e){if(e!=null&&!isFinite(e)){return this}var t=this.getVisibleRowCountMode();if(t==I.Auto){_.error("VisibleRowCount will be ignored since VisibleRowCountMode is set to Auto",this);return this}var i=this.getFixedRowCount()+this.getFixedBottomRowCount();if(e<=i&&i>0){_.error("Table: "+this.getId()+" visibleRowCount('"+e+"') must be bigger than number of fixed rows('"+(this.getFixedRowCount()+this.getFixedBottomRowCount())+"')",this);return this}e=this.validateProperty("visibleRowCount",e);if(this.getBinding("rows")&&this._getTotalRowCount()<=e){this.setProperty("firstVisibleRow",0)}this.setProperty("visibleRowCount",e);this._setRowContentHeight(e*this._getDefaultRowHeight());p.dynamicCall(this._getSyncExtension,function(t){t.syncRowCount(e)});return this};F.prototype.setMinAutoRowCount=function(e){if(parseInt(e)<1){_.error("The minAutoRowCount property must be greater than 0. The value has been set to 1.",this);e=1}this.setProperty("minAutoRowCount",e);return this};F.prototype.setRowHeight=function(e){this.setProperty("rowHeight",e);this._iTableRowContentHeight=undefined;return this};F.prototype.setTooltip=function(e){_.warning("The aggregation tooltip is not supported for sap.ui.table.Table");return this.setAggregation("tooltip",e,true)};F.prototype.setNavigationMode=function(){this.setProperty("navigationMode",x.Scrollbar,true);_.error("The navigationMode property is deprecated and must not be used anymore. Your setting was defaulted to 'Scrollbar'",this);return this};F.prototype._getFixedBottomRowContexts=function(e,t){var i=this.getBinding("rows");var o=[];if(!i){return o}e=e||this.getFixedBottomRowCount();t=t||this._getTotalRowCount();var n=this.getVisibleRowCount();if(e>0&&n-e<t){o=this._getContexts(t-e,e)}return o};F.prototype._getFixedRowContexts=function(e){e=e||this.getFixedRowCount();if(e>0){return this._getContexts(0,e)}else{return[]}};F.prototype._getContexts=function(e,t,i){var o=this.getBinding("rows");if(o){return o.getContexts(e,t,i)}else{return[]}};F.prototype._computeRequestLength=function(t){if(this.getVisibleRowCountMode()===I.Auto&&!this._bContextsRequested){var i=Math.ceil(e.resize.height/p.DEFAULT_ROW_HEIGHT.sapUiSizeCondensed);return Math.max(t,i)}return t};F.prototype._getRowContexts=function(e,t,i){var o=this.getBinding("rows");var n=e==null?this.getRows().length:e;if(!o||n<=0){return[]}t=t===true;i=i===true;var r=this._getFirstRenderedRowIndex();var s=this.getFixedRowCount();var a=this.getFixedBottomRowCount();var l=[];var u;var h=n-a;var d=0;var p=h;var g=this.getThreshold();g=g?Math.max(n,g):0;var c=r;var f=function(e,t,i){for(var o=0;o<t.length;o++){e[i+o]=t[o]}};if(s>0&&r>0){c=r+s;h-=s;d=s;u=this._getFixedRowContexts(s);l=l.concat(u)}u=this._getContexts(c,this._computeRequestLength(h),g);if(!t){this._adjustToTotalRowCount()}var w=this._getTotalRowCount();this._bContextsRequested=true;f(l,u,d);p=Math.min(p,Math.max(w-a,0));if(a>0){u=this._getFixedBottomRowContexts(a,w);f(l,u,p)}var R=this._getMaxFirstRenderedRowIndex();if(R<r&&this._bContextsAvailable&&!i){this.setProperty("firstVisibleRow",R,true);l=this._getRowContexts(n,t,true)}return l};F.prototype._adjustToTotalRowCount=function(){var e=this.getBinding("rows");var t=this._getTotalRowCount();var i=this._getScrollExtension();if(this._iBindingLength!==t){this._iBindingLength=t;this._updateFixedBottomRows();i.updateVerticalScrollbarVisibility();i.updateVerticalScrollHeight();if(!e||!p.hasPendingRequests(this)){this._updateNoData()}}};F.prototype.refreshRows=function(e){var t=this.getBinding("rows");if(!t){_.error("RefreshRows must not be called without a binding",this);return}this._bContextsAvailable=false;var i=this;var o=typeof e==="object"?e.getParameter("reason"):e;var n=this.getVisibleRowCountMode();var s=n===I.Auto;var a=s&&this.bOutput;if(!s||a){if(this.bOutput&&this.getRows().length===0){t.attachEventOnce("dataRequested",function(){if(i._mTimeouts.refreshRowsAdjustRows){window.clearTimeout(i._mTimeouts.refreshRowsAdjustRows)}i._mTimeouts.refreshRowsAdjustRows=window.setTimeout(function(){i._updateRows(i._calculateRowsToDisplay(),o,false)},0)})}if(o===r.Filter||o===r.Sort){this.setFirstVisibleRow(0)}var l=o!=null;this._updateBindingContexts(this._calculateRowsToDisplay(),l)}};F.prototype.updateRows=function(e){if(this.bIsDestroyed||this._bIsBeingDestroyed){return}if(!this._bRowsBeingBound||this._getTotalRowCount(true)>0){this._bContextsAvailable=true}var t=this.getVisibleRowCountMode();var i=this.getRows().length===0||this._bRowAggregationInvalid;var o=t===I.Auto;var n=o&&this.bOutput;if(i&&(!o||n)){if(this._iTableRowContentHeight){var r=this._updateRows(this._calculateRowsToDisplay(),e);if(r){return}}}this._performUpdateRows(e)};F.prototype.insertRow=function(){_.error('The control manages the rows aggregation. The method "insertRow" cannot be used programmatically!',this);return this};F.prototype.addRow=function(){_.error('The control manages the rows aggregation. The method "addRow" cannot be used programmatically!',this);return this};F.prototype.removeRow=function(){_.error('The control manages the rows aggregation. The method "removeRow" cannot be used programmatically!',this);return null};F.prototype.removeAllRows=function(){_.error('The control manages the rows aggregation. The method "removeAllRows" cannot be used programmatically!',this);return[]};F.prototype.destroyRows=function(){_.error('The control manages the rows aggregation. The method "destroyRows" cannot be used programmatically!',this);return this};F.prototype.autoResizeColumn=function(e){this._getPointerExtension().doAutoResizeColumn(e)};F.prototype._attachEvents=function(){var t=this.$();if(sap.ui.getCore().getConfiguration().getAnimation()){y(document.body).on("webkitTransitionEnd transitionend",function(e){if(y(e.target).has(t).length>0){this._updateTableSizes(p.RowsUpdateReason.Animation)}}.bind(this))}e.resize.attachHandler(this._onWindowResize,this);g.attachEvents(this)};F.prototype._detachEvents=function(){y(document.body).off("webkitTransitionEnd transitionend");p.deregisterResizeHandler(this);e.resize.detachHandler(this._onWindowResize,this);g.detachEvents(this)};F.prototype._cleanUpTimers=function(){var e;for(e in this._mTimeouts){if(this._mTimeouts[e]){window.clearTimeout(this._mTimeouts[e]);delete this._mTimeouts[e]}}for(e in this._mAnimationFrames){if(this._mAnimationFrames[e]){window.cancelAnimationFrame(this._mAnimationFrames[e]);delete this._mAnimationFrames[e]}}this._performUpdateRows.cancel()};F.prototype._updateBindingContexts=function(e,t){var i=this.getBinding("rows");var o;t=t===true;if(i){o=this._getRowContexts(e,t)}if(!t){this._resetRowHeights();var n=this.getRows(),r=this.mBindingInfos["rows"],s=r&&r.model;for(var a=n.length-1;a>=0;a--){var l=o?o[a]:undefined;var u=n[a];if(u){u.setRowBindingContext(l,s,i)}}}};F.prototype._updateNoData=function(){if(!this.getDomRef()){return}var e=document.activeElement;this.$().toggleClass("sapUiTableEmpty",p.isNoDataVisible(this));this._getAccExtension().updateAriaStateForOverlayAndNoData();this._getKeyboardExtension().updateNoDataAndOverlayFocus(e)};F.prototype.removeColumn=function(e,t){var i=this.removeAggregation("columns",e,t);if(typeof e==="number"&&e>-1){e=this.getColumns()[e]}var o=this._aSortedColumns.indexOf(e);if(!this._bReorderInProcess&&o>=0){this._aSortedColumns.splice(o,1)}this.invalidateRowsAggregation();return i};F.prototype.removeAllColumns=function(){var e=this.removeAllAggregation("columns");this._aSortedColumns=[];this.invalidateRowsAggregation();return e};F.prototype.destroyColumns=function(){var e=this.destroyAggregation("columns");this._aSortedColumns=[];this.invalidateRowsAggregation();return e};F.prototype.addColumn=function(e,t){this.addAggregation("columns",e,t);this.invalidateRowsAggregation();return this};F.prototype.insertColumn=function(e,t,i){this.insertAggregation("columns",e,t,i);this.invalidateRowsAggregation();return this};F.prototype._getTotalRowCount=function(){var e=this.getBinding("rows");return e?e.getLength():0};F.prototype._getSelectableRowCount=function(){return this._oSelectionAdapter.getSelectableCount()};F.prototype._getMaxFirstVisibleRowIndex=function(){var e;if(p.isVariableRowHeightEnabled(this)){e=this._getTotalRowCount(true)-1}else{e=this._getTotalRowCount(true)-this.getVisibleRowCount()}return Math.max(0,e)};F.prototype._getMaxFirstRenderedRowIndex=function(){var e;if(p.isVariableRowHeightEnabled(this)){e=this._getTotalRowCount(true)-this.getVisibleRowCount()-1}else{e=this._getTotalRowCount(true)-this.getVisibleRowCount()}return Math.max(0,e)};F.prototype._getFirstRenderedRowIndex=function(){var e=this.getFirstVisibleRow();if(p.isVariableRowHeightEnabled(this)&&e>this._getMaxFirstRenderedRowIndex()){return this._getMaxFirstRenderedRowIndex()}else{return e}};F.prototype._getVisibleColumns=function(){var e=[];var t=this.getColumns();for(var i=0,o=t.length;i<o;i++){if(t[i].shouldRender()){e.push(t[i])}}return e};F.prototype._getColumnsWidth=function(e,t){var i=this.getColumns();var o=0;if(e!==0&&!e){e=0}if(t!==0&&!t){t=i.length}for(var n=e,r=t;n<r;n++){if(i[n]&&i[n].shouldRender()){o+=this._CSSSizeToPixel(i[n].getWidth())}}return o};F.prototype._CSSSizeToPixel=function(e,t){var i=p.Column.getMinColumnWidth();if(e){if(e.endsWith("px")){i=parseInt(e)}else if(e.endsWith("em")||e.endsWith("rem")){i=Math.ceil(parseFloat(e)*this._getBaseFontSize())}}if(t){return i+"px"}else{return parseInt(i)}};F.prototype._getBaseFontSize=function(){return this._iBaseFontSize};F.prototype._onTableResize=function(){if(this._bInvalid||!this.getDomRef()){return}this._updateTableSizes(p.RowsUpdateReason.Resize)};F.prototype._onWindowResize=function(){if(this._bInvalid||!this.getDomRef()){return}if(e.browser.chrome&&window.devicePixelRatio!==this._nDevicePixelRatio){this._nDevicePixelRatio=window.devicePixelRatio;this._updateTableSizes(p.RowsUpdateReason.Zoom)}};F.prototype._disableTextSelection=function(e){y(e||document.body).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).bind("selectstart",function(e){e.preventDefault();return false})};F.prototype._enableTextSelection=function(e){y(e||document.body).attr("unselectable","off").css({"-moz-user-select":"","-webkit-user-select":"","user-select":""}).unbind("selectstart")};F.prototype._clearTextSelection=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}else if(document.selection&&document.selection.empty){try{document.selection.empty()}catch(e){}}};F.prototype._findAndfireCellEvent=function(e,t,i){var o=y(t.target);var n=o.closest("td.sapUiTableTd");var r=n.attr("id");var s=/.*-row(\d*)-col(\d*)/i.exec(r);var a=false;if(s){var l=s[1];var u=s[2];var h=this.getRows()[l];var d=h&&h.getCells()[u];var p=h&&h.getIndex();var g=d.data("sap-ui-colid");var c;if(this.getBindingInfo("rows")){c=h.getBindingContext(this.getBindingInfo("rows").model)}var f={rowIndex:p,columnIndex:u,columnId:g,cellControl:d,rowBindingContext:c,cellDomRef:n.get(0)};a=!e.call(this,f);if(!a&&typeof i==="function"){f.cellDomRef=n[0];a=i.call(this,f)}}return a};F.prototype.getFocusDomRef=function(){this._getKeyboardExtension().initItemNavigation();var e=p.getFocusedItemInfo(this);if(e){return e.domRef||t.prototype.getFocusDomRef.apply(this,arguments)}return null};F.prototype._isRowSelectable=function(e){return this._oSelectionAdapter.isIndexSelectable(e)};F.prototype.pushSortedColumn=function(e,t){if(!t){this._aSortedColumns=[]}this._aSortedColumns.push(e)};F.prototype.getSortedColumns=function(){return this._aSortedColumns.slice()};F.prototype.sort=function(e,t,i){if(!e){for(var o=0;o<this._aSortedColumns.length;o++){this._aSortedColumns[o].setSorted(false)}var n=this.getBinding("rows");if(n){n.sort()}this._aSortedColumns=[]}if(this.getColumns().indexOf(e)>=0){e.sort(t===A.Descending,i)}};F.prototype.filter=function(e,t){if(this.getColumns().indexOf(e)>=0){e.filter(t)}};F.prototype._updateSelection=function(){var e=this.getSelectionMode();if(e===S.None){return}var t=this._getAccExtension().getAriaTextsForSelectionMode(true);var i=p.isRowSelectionAllowed(this);var o=this.getRows();for(var n=0;n<o.length;n++){var r=o[n];r._updateSelection(this,t,i)}this.setProperty("selectedIndex",this.getSelectedIndex(),true);if(p.hasSelectAll(this)){var s=this.$("selall");var a=p.areAllRowsSelected(this);s.toggleClass("sapUiTableSelAll",!a);this._getAccExtension().setSelectAllState(a);if(this._getShowStandardTooltips()){s.attr("title",p.getResourceText(a?"TBL_DESELECT_ALL":"TBL_SELECT_ALL"))}}};F.prototype._getShowStandardTooltips=function(){return!this._bHideStandardTooltips};F.prototype._onSelectionChanged=function(e){var t=e.getParameter("rowIndices");var i=e.getParameter("selectAll");var o=this._iSourceRowIndex!==undefined?this._iSourceRowIndex:this.getSelectedIndex();this._updateSelection();this.fireRowSelectionChange({rowIndex:o,rowContext:this.getContextByIndex(o),rowIndices:t,selectAll:i,userInteraction:this._iSourceRowIndex!==undefined})};F.prototype.getContextByIndex=function(e){var t=this.getBinding("rows");return e>=0&&t?t.getContexts(e,1)[0]:null};F.prototype.getSelectedIndex=function(){return this._oSelectionAdapter.getSelectedIndex()};F.prototype.setSelectedIndex=function(e){this._oSelectionAdapter.setSelectedIndex(e);return this};F.prototype.clearSelection=function(){this._oSelectionAdapter.clearSelection();return this};F.prototype.selectAll=function(){if(p.hasSelectAll(this)){this._oSelectionAdapter.selectAll()}return this};F.prototype.getSelectedIndices=function(){return this._oSelectionAdapter.getSelectedIndices()};F.prototype.addSelectionInterval=function(e,t){this._oSelectionAdapter.addSelectionInterval(e,t);return this};F.prototype.setSelectionInterval=function(e,t){this._oSelectionAdapter.setSelectionInterval(e,t);return this};F.prototype.removeSelectionInterval=function(e,t){this._oSelectionAdapter.removeSelectionInterval(e,t);return this};F.prototype.isIndexSelected=function(e){return this._oSelectionAdapter.isIndexSelected(e)};F.prototype.setGroupBy=function(e){var t=e;var i=sap.ui.getCore().byId(this.getGroupBy());if(typeof t==="string"){t=sap.ui.getCore().byId(t)}var o=false;if(t instanceof u&&t!==i){if(this.getColumns().indexOf(t)===-1){throw new Error("Column has to be part of the columns aggregation!")}var n=this.fireGroup({column:t,groupedColumns:[t.getId()],type:C.group});if(i){i.setGrouped(false);o=true}if(n&&this.getEnableGrouping()){t.setGrouped(true)}}if(!t||o){if(i){i.setGrouped(false)}p.Grouping.resetExperimentalGrouping(this)}return this.setAssociation("groupBy",t)};F.prototype.getBinding=function(e){p.Grouping.setupExperimentalGrouping(this);return i.prototype.getBinding.call(this,[e||"rows"])};F.prototype.setEnableGrouping=function(e){var t=sap.ui.getCore().byId(this.getGroupBy());this.setProperty("enableGrouping",e);if(t){t.setGrouped(e)}p.Grouping.resetExperimentalGrouping(this);this._invalidateColumnMenus();return this};F.prototype.setEnableCustomFilter=function(e){this.setProperty("enableCustomFilter",e);this._invalidateColumnMenus();return this};F.prototype.setEnableColumnFreeze=function(e){this.setProperty("enableColumnFreeze",e);this._invalidateColumnMenus();return this};F.prototype.setShowColumnVisibilityMenu=function(e){this.setProperty("showColumnVisibilityMenu",e);this._invalidateColumnMenus();return this};F.prototype.getComputedFixedColumnCount=function(){if(this._bIgnoreFixedColumnCount){return 0}return this.getFixedColumnCount()};F.prototype.setFixedColumnCount=function(e,t){var i=this.getColumns();var o,n;for(n=e-1;n>=0;n--){o=i[n];if(o&&o.getVisible()){e=Math.max(e,o.getIndex()+p.Column.getHeaderSpan(o));break}}var r=this.$().find(".sapUiTableCtrlFirstCol > th");for(n=e-1;n>=0;n--){o=i[n];if(o&&p.isVariableWidth(o.getWidth())){o._iFixWidth=r.filter("[data-sap-ui-headcolindex='"+o.getIndex()+"']").width()}}this.setProperty("fixedColumnCount",e,t);this._collectTableSizes();if(this.getEnableColumnFreeze()){this._invalidateColumnMenus()}return this};F.prototype.setFixedRowCount=function(e){if(!(parseInt(e)>=0)){_.error("Number of fixed rows must be greater or equal 0",this);return this}if(e+this.getFixedBottomRowCount()<this.getVisibleRowCount()){this.setProperty("fixedRowCount",e);this._updateBindingContexts()}else{_.error("Table '"+this.getId()+"' fixed rows('"+(e+this.getFixedBottomRowCount())+"') must be smaller than numberOfVisibleRows('"+this.getVisibleRowCount()+"')",this)}return this};F.prototype.setFixedBottomRowCount=function(e){if(!(parseInt(e)>=0)){_.error("Number of fixed bottom rows must be greater or equal 0",this);return this}if(e+this.getFixedRowCount()<this.getVisibleRowCount()){this.setProperty("fixedBottomRowCount",e);this._updateBindingContexts()}else{_.error("Table '"+this.getId()+"' fixed rows('"+(e+this.getFixedRowCount())+"') must be smaller than numberOfVisibleRows('"+this.getVisibleRowCount()+"')",this)}return this};F.prototype.setThreshold=function(e){this.setProperty("threshold",e,true);return this};F.prototype._invalidateColumnMenus=function(){var e=this.getColumns();for(var t=0,i=e.length;t<i;t++){e[t].invalidateMenu()}};F.prototype._isTouchEvent=function(e){return!!(e&&e.originalEvent&&e.originalEvent.touches)};F.prototype._getRowClone=function(e){var t=this._aRowClones[e];if(t&&!t.bIsDestroyed){return t}t=new h(this.getId()+"-rows"+"-row"+e);this._aRowClones[e]=t;var i=this.getColumns();for(var o=0,n=i.length;o<n;o++){if(i[o].getVisible()){var r=i[o].getTemplateClone(o);if(r){t.addCell(r)}}}if(p.hasRowActions(this)){var s=this.getRowActionTemplate().clone();s._setFixedLayout(true);s._setCount(this.getRowActionCount());s._setIconLabel(this.getId()+"-rowacthdr");t.setAggregation("_rowAction",s,true)}var a=this.getRowSettingsTemplate();if(a){var l=a.clone();t.setAggregation("_settings",l,true)}return t};F.prototype.invalidateRowsAggregation=function(){this._bRowAggregationInvalid=true};F.prototype._updateRows=function(e,t,i){if(isNaN(e)){return false}if(i==null){i=true}var o=this.getBinding("rows");var n=this.getRows();var r;this.setProperty("visibleRowCount",e,true);if(p.isNoDataVisible(this)&&!o){e=0}else if(p.isVariableRowHeightEnabled(this)){e=e+1}p.dynamicCall(this._getSyncExtension,function(t){t.syncRowCount(e)},this);if(this._bRowAggregationInvalid){this.destroyAggregation("rows",true);n=[]}if(e===n.length){return false}for(r=n.length-1;r>=e;r--){this.removeAggregation("rows",r,true)}n.splice(e);var s;var a;var l;if(i){a=this.getBindingInfo("rows");l=a&&a.model;s=this._getRowContexts(e);for(r=0;r<n.length;r++){n[r].setRowBindingContext(s[r],l,o)}}if(n.length<e){for(r=n.length;r<e;r++){var u=this._getRowClone(r);if(i){u.setRowBindingContext(s[r],l,o)}this.addAggregation("rows",u,true);this._bRowAggregationInvalid=false;if(i){u._updateTableCells(s[r])}}}this._iRenderedFirstVisibleRow=this._getFirstRenderedRowIndex();var h=i&&s.length>0;return this._renderRows(t,h)};F.prototype._renderRows=function(e,t){var i=false;t=t===true;if(!this._bInvalid){var o=this.getDomRef("tableCCnt");if(!o){return false}this._detachEvents();if(this.getVisibleRowCountMode()===I.Auto){var n=this.getDomRef();if(n){n.style.height="0px"}}var r=y.Event("BeforeRendering");r.setMarked("renderRows");r.srcControl=this;this._handleEvent(r);var s=sap.ui.getCore().createRenderManager(),a=this.getRenderer();a.renderTableCCnt(s,this);s.flush(o,false,false);s.destroy();r=y.Event("AfterRendering");r.setMarked("renderRows");r.srcControl=this;this._handleEvent(r);i=true}if(t&&!this._bInvalid&&this.getBinding("rows")){var l=this;if(this._mTimeouts._rowsUpdated){window.clearTimeout(this._mTimeouts._rowsUpdated)}this._mTimeouts._rowsUpdated=window.setTimeout(function(){l._fireRowsUpdated(e)},0)}return i};F.prototype._getDefaultRowHeight=function(){var e=this.getRowHeight();if(e>0){return e+p.ROW_HORIZONTAL_FRAME_SIZE}else{var t=p.getContentDensity(this);return p.DEFAULT_ROW_HEIGHT[t]}};F.prototype._setRowContentHeight=function(e){e=e||0;var t=this.getVisibleRowCountMode();var i=this.getVisibleRowCount();var o=this._getDefaultRowHeight();var n=this.getMinAutoRowCount();var r;if(t==I.Interactive||t==I.Fixed){if(this._iTableRowContentHeight&&t==I.Interactive){r=n*o;if(!e){e=this._iTableRowContentHeight}}else{r=i*o;e=r}}else if(t==I.Auto){r=n*o}var s=Math.max(e,r);if(t==I.Fixed&&this.getRows().length==0||t!=I.Fixed){this._iTableRowContentHeight=Math.floor(s/o)*o}else{this._iTableRowContentHeight=undefined}if(p.isVariableRowHeightEnabled(this)){y(this.getDomRef("tableCCnt")).css("height",o*i+"px")}else{if((t==I.Fixed||t==I.Interactive)&&this.getRows().length>0){y(this.getDomRef("tableCtrlCnt")).css("height","auto")}else{y(this.getDomRef("tableCtrlCnt")).css("height",this._iTableRowContentHeight+"px")}}};F.prototype._determineMinAutoRowCount=function(){var e=this.getMinAutoRowCount();if(this.getVisibleRowCountMode()==I.Interactive&&!this.bOutput){e=this.getVisibleRowCount()||e}return e};F.prototype._calculateRowsToDisplay=function(e){this._iRowsToDisplayHeight=e||this._iRowsToDisplayHeight||this._iTableRowContentHeight;e=this._iRowsToDisplayHeight;var t=this.getVisibleRowCountMode();var i=0;if(t==I.Fixed){i=this.getVisibleRowCount()||0}else if(t==I.Interactive||t==I.Auto){var o=this._determineMinAutoRowCount();var n=this._getDefaultRowHeight();if(!n||!e){i=o}else{var r=Math.min(e,5e4);var s=Math.floor(r/n);i=Math.max(this.getFixedRowCount()+this.getFixedBottomRowCount()+1,Math.max(o,s))}}return Math.max(i,0)};F.prototype.setShowNoData=function(e){this.setProperty("showNoData",e,true);this._updateNoData();return this};F.prototype.setNoData=function(e){var t=p.getNoDataText(this);this.setAggregation("noData",e,true);var i=p.getNoDataText(this);if(t!=null&&i!=null){if(t!==i){this.$("noDataMsg").text(i)}}else{this.invalidate()}return this};F.prototype.exportData=function(e){var t=sap.ui.requireSync("sap/ui/core/util/Export");e=e||{};if(!e.rows){var i=this.getBinding("rows"),o=this.getBindingInfo("rows");var n=i.aFilters.concat(i.aApplicationFilters);e.rows={path:o.path,model:o.model,sorter:i.aSorters,filters:n,parameters:o.parameters}}if(!e.exportType){var r=sap.ui.requireSync("sap/ui/core/util/ExportTypeCSV");e.exportType=new r}var s=e.rows.model;if(!s){var a=e.rows.path;var l=a.indexOf(">");if(l>0){s=a.substr(0,l)}}if(!e.columns){e.columns=[];var u=this.getColumns();for(var h=0,d=u.length;h<d;h++){var p=u[h];if(p.getSortProperty()){e.columns.push({name:p.getLabel().getText(),template:{content:{path:p.getSortProperty(),model:s}}})}}}var g=new t(e);this.addDependent(g);return g};F.prototype._onPersoApplied=function(){var e=this.getColumns();var t=[];for(var i=0,o=e.length;i<o;i++){var n=e[i];if(n.getSorted()){t.push(new a(n.getSortProperty(),n.getSortOrder()===A.Descending))}}var r=this.getBinding("rows");if(r){if(t.length>0){r.sort(t)}this.refreshRows()}};F.prototype._toggleSelectAll=function(){if(!p.hasData(this)||this.getSelectionMode()!==S.MultiToggle){return}if(p.areAllRowsSelected(this)){this._iSourceRowIndex=-1;this.clearSelection()}else{this._iSourceRowIndex=0;this.selectAll()}this._iSourceRowIndex=undefined};F.prototype.setBusy=function(e,i){var o=this.getBusy()!=e;i="sapUiTableCnt";var n=t.prototype.setBusy.call(this,e,i);if(o){this.fireBusyStateChanged({busy:e})}return n};F.prototype.setEnableBusyIndicator=function(e){this.setProperty("enableBusyIndicator",e,true);if(!e){this.setBusy(false)}return this};F.prototype._onBindingDataRequested=function(e){if(e.getSource()!=this.getBinding("rows")||e.getParameter("__simulateAsyncAnalyticalBinding")){return}this._iPendingRequests++;this._bPendingRequest=true;var t=p.canUsePendingRequestsCounter(this);if(this.getEnableBusyIndicator()&&(t&&this._iPendingRequests===1||!t)){this.setBusy(true)}if(this._dataReceivedHandlerId!=null){clearTimeout(this._dataReceivedHandlerId);delete this._dataReceivedHandlerId}};F.prototype._onBindingDataReceived=function(e){if(e.getSource()!=this.getBinding("rows")||e.getParameter("__simulateAsyncAnalyticalBinding")){return}this._iPendingRequests--;this._bPendingRequest=false;if(this._mTimeouts.refreshRowsAdjustRows){window.clearTimeout(this._mTimeouts.refreshRowsAdjustRows)}this._adjustToTotalRowCount();if(!p.hasPendingRequests(this)){this._dataReceivedHandlerId=setTimeout(function(){if(this.getEnableBusyIndicator()){this.setBusy(false)}this._updateNoData();delete this._dataReceivedHandlerId}.bind(this),0)}};F.prototype._setLargeDataScrolling=function(e){this._bLargeDataScrolling=!!e};F.prototype._getSelectedIndicesCount=function(){return this._oSelectionAdapter.getSelectedCount()};F.prototype._updateTableContent=function(){p.Grouping.updateGroups(this)};F.prototype.setRowActionTemplate=function(e){this.setAggregation("rowActionTemplate",e);e=this.getRowActionTemplate();if(e){e._setCount(this.getRowActionCount())}this.invalidateRowsAggregation();return this};F.prototype.setRowActionCount=function(e){this.setProperty("rowActionCount",e);e=this.getRowActionCount();var t=this.getRowActionTemplate();if(t){t._setCount(e)}for(var i=0;i<this._aRowClones.length;i++){t=this._aRowClones[i].getAggregation("_rowAction");if(t){t._setCount(e)}}return this};F.prototype.setRowSettingsTemplate=function(e){this.setAggregation("rowSettingsTemplate",e);this.invalidateRowsAggregation();return this};F.prototype._validateRow=function(e){return e&&e instanceof h&&e.getParent()===this};F.prototype.getRowForCell=function(e){if(e){var t=e.getParent();if(this._validateRow(t)){return t}}return null};F.prototype.getColumnForCell=function(e){if(this.getRowForCell(e)){var t=e.data("sap-ui-colindex");var i=this.getColumns();if(t>=0&&t<i.length){return i[t]}}return null};F.prototype.getCellControl=function(e,t,i){var o=p.getRowColCell(this,e,t,!i);return o.cell};F.prototype._fireRowsUpdated=function(e){if(e==null){e=p.RowsUpdateReason.Unknown}this.fireEvent("_rowsUpdated",{reason:e})};F.prototype._enableSynchronization=function(){var e=this;return new Promise(function(t,i){sap.ui.require(["sap/ui/table/TableSyncExtension"],function(i){t(g.enrich(e,i).getInterface())},function(e){i(e)})})};F.prototype._enableLegacyMultiSelection=function(){this._legacyMultiSelection=function(e,t){var i=!!(t.metaKey||t.ctrlKey);if(!this.isIndexSelected(e)){if(i){this.addSelectionInterval(e,e)}else{this.setSelectedIndex(e)}}else if(i||this._getSelectedIndicesCount()===1){this.removeSelectionInterval(e,e)}else{this.setSelectedIndex(e)}}.bind(this)};return F});