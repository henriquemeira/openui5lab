/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/ChangeReason","sap/ui/model/ClientListBinding","sap/ui/util/XMLHelper","sap/base/util/array/diff","sap/base/util/deepEqual","sap/ui/thirdparty/jquery"],function(t,e,i,s,n,a){"use strict";var h=e.extend("sap.ui.model.xml.XMLListBinding");h.prototype.getContexts=function(t,e){this.iLastStartIndex=t;this.iLastLength=e;if(!t){t=0}if(!e){e=Math.min(this.iLength,this.oModel.iSizeLimit)}var i=this._getContexts(t,e),n=[];if(this.bUseExtendedChangeDetection){for(var a=0;a<i.length;a++){n.push(this.getContextData(i[a]))}if(this.aLastContexts&&t<this.iLastEndIndex){i.diff=s(this.aLastContextData,n)}this.iLastEndIndex=t+e;this.aLastContexts=i.slice(0);this.aLastContextData=n.slice(0)}return i};h.prototype.getCurrentContexts=function(){if(this.bUseExtendedChangeDetection){return this.aLastContexts||[]}else{return this.getContexts(this.iLastStartIndex,this.iLastLength)}};h.prototype.getEntryData=function(t){return i.serialize(t.getObject())};h.prototype.update=function(){var t=this.oModel._getObject(this.sPath,this.oContext);if(t){this.oList=[];var e=this;if(this.bUseExtendedChangeDetection){a.each(t,function(t,i){e.oList.push(i.cloneNode(true))})}else{this.oList=t.slice(0)}this.updateIndices();this.applyFilter();this.applySort();this.iLength=this._getLength()}else{this.oList=[];this.aIndices=[];this.iLength=0}};h.prototype.checkUpdate=function(e){if(this.bSuspended&&!this.bIgnoreSuspend&&!e){return}if(!this.bUseExtendedChangeDetection){var i=this.oModel._getObject(this.sPath,this.oContext)||[];if(i.length!=this.oList.length||e){this.update();this._fireChange({reason:t.Change})}}else{var s=false;var h=this;var i=this.oModel._getObject(this.sPath,this.oContext)||[];if(this.oList.length!=i.length){s=true}if(!n(this.oList,i)){this.update()}var o=this._getContexts(this.iLastStartIndex,this.iLastLength);if(this.aLastContexts){if(this.aLastContexts.length!=o.length){s=true}else{a.each(this.aLastContextData,function(t,e){var i=h.getContextData(o[t]);if(i!==e){s=true;return false}})}}else{s=true}if(s||e){this._fireChange({reason:t.Change})}}};return h});