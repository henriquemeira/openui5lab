/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
(function(){"use strict";var e=[],t=[],n,r=/\w/;function i(e,n,r,i){if(n>=0){if(r){t[e].branchTracking[n].truthy+=1}else{t[e].branchTracking[n].falsy+=1}}if(i>=0){l(e,i)}return r}function a(e,t,n){var r=parseInt(e.getAttribute(t));return r>0?r:n}function s(){var e,t=document.getElementsByTagName("script"),n,r;for(n=0,r=t.length;n<r;n+=1){e=t[n];if(/BranchTracking.js$/.test(e.getAttribute("src"))){return e}}}function o(n,r){var i=blanket.options("branchTracking"),a=false,s,o=e.length,c=n.inputFileName,u,l=n.inputFile,h;if(l.indexOf("// sap-ui-cover-browser msie")>=0){a=true;s=sap.ui.require("sap/ui/Device");if(s&&s.browser.msie){s=undefined}}e.push(c);t[o]=_$blanket[c]=[];if(i){_$blanket[c].branchTracking=[]}_$blanket[c].source=l.split("\n");_$blanket[c].source.unshift("");h=""+falafel(l,{attachComment:a,comment:a,loc:true,range:true,source:l},f.bind(null,i,o,s));u=h.split("\n").length+1;if(u!==_$blanket[c].source.length){jQuery.sap.log.warning("Line length mismatch! "+_$blanket[c].source.length+" vs. "+u,c,"sap.ui.test.BranchTracking")}r(h)}function c(e,t){if(!("$ignored"in t)){if(t.parent&&c(e,t.parent)){t.$ignored=true}else{t.$ignored=t.type==="BlockStatement"&&u(e,t)}}return t.$ignored}function u(e,t){function n(t){return t.type==="Line"&&t.value===" sap-ui-cover-browser msie"&&!(e&&e.browser.msie)}return t.body[0]&&t.body[0].leadingComments&&t.body[0].leadingComments.some(n)}function l(e,n){t[e][n]+=1}function f(n,i,a,s){var o=t[i],l=o.branchTracking,f=s.loc.start.line,h;function p(){s.update("blanket.$l("+i+", "+f+"); "+s.source());g();return true}function g(){if(f in o){jQuery.sap.log.warning("Multiple statements on same line detected"+" â€“ minified code not supported! Line number "+f,e[i],"sap.ui.test.BranchTracking")}o[f]=0}function b(){var e=s.loc.source.slice(s.left.range[1],s.right.range[0]);if(e[0]===")"){e=e.slice(1)}if(e.slice(-1)==="("){e=e.slice(0,-1)}return e}if(a&&c(a,s)){return false}switch(s.type){case"AssignmentExpression":case"ArrayExpression":case"BlockStatement":case"BinaryExpression":case"Block":case"CallExpression":case"CatchClause":case"DebuggerStatement":case"EmptyStatement":case"FunctionExpression":case"Identifier":case"Line":case"Literal":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"Program":case"Property":case"SequenceExpression":case"SwitchCase":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"VariableDeclarator":return false;case"ConditionalExpression":if(!n){return false}s.test.update("blanket.$b("+i+", "+l.length+", "+s.test.source()+")");l.push({alternate:s.alternate.loc,consequent:s.consequent.loc,falsy:0,truthy:0});return true;case"ExpressionStatement":if(s.expression.type==="Literal"&&s.expression.value==="use strict"){return false}case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"WithStatement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":return p(s);case"IfStatement":if(u(undefined,s.consequent)){n=false}s.test.update("blanket.$b("+i+", "+(n?l.length:-1)+", "+s.test.source()+", "+f+")");g();if(n){l.push({alternate:(s.alternate||s.test).loc,consequent:s.consequent.loc,falsy:0,truthy:0})}return true;case"LogicalExpression":if(!n){return false}if(s.operator==="||"||s.operator==="&&"){h="blanket.$b("+i+", "+l.length+", "+s.left.source()+") "+b()+" ("+s.right.source()+")";if(!r.test(s.loc.source[s.range[0]])){h=" "+h}s.update(h);l.push({alternate:s.operator==="&&"?s.left.loc:s.right.loc,consequent:s.operator==="&&"?s.right.loc:s.left.loc,falsy:0,truthy:0})}return true;case"VariableDeclaration":if(s.parent.type==="ForInStatement"||s.parent.type==="ForStatement"){return false}return p(s);case"LabeledStatement":default:throw new Error(s.source())}}function h(){var e={},t=[],n;QUnit.begin(function(t){n=t.modules.length;t.modules.forEach(function(t){e[t.name]=t})});QUnit.moduleStart(function(n){t=t.concat(Object.keys(e).filter(function(t){return e[t].tests===n.tests}))});return function(){return t.length<n?t:undefined}}if(window.blanket){window._$blanket={};blanket.$b=i;blanket.$l=l;blanket.instrument=o;var p=h(),g=s(),b=a(g,"data-lines-of-context",3);n=Math.min(a(g,"data-threshold",0),100);sap.ui.require(["sap/ui/test/BlanketReporter"],function(e){blanket.options("reporter",e.bind(null,b,n,p))})}var m,d="sap.ui.base.SyncPromise",k={},y,$=0,w,S={};function v(e,t){var n,r=_$blanket[e.$currentFileName],i=k[e.$currentFileName],a;if(e.$oldHits){a=Object.keys(r).filter(function(t){return!(i&&i[t])&&r[t]===e.$oldHits[t]});t.notOk(a.length,"Some lines have not been covered by this module in isolation: "+a)}if(e.$oldBranchTracking){n=Object.keys(r.branchTracking).filter(function(t){return r.branchTracking[t].falsy===e.$oldBranchTracking[t].falsy||r.branchTracking[t].truthy===e.$oldBranchTracking[t].truthy});t.notOk(n.length,"Some branches have not been fully covered by this module in isolation: "+n)}}function E(e){var t,n=Object.keys(S).length,r="Uncaught (in promise): "+n+" times\n",i;if(n){for(t in S){i=S[t];if(i.getResult()&&i.getResult().stack){r+=i.getResult().stack}else{r+=i.getResult()}if(i.$error.stack){r+="\n>>> SyncPromise rejected with above reason...\n"+i.$error.stack.split("\n").slice(2).join("\n")}r+="\n\n"}S={};if(e){e(r)}else if(m){jQuery.sap.log.info("Clearing "+n+" uncaught promises",r,d)}}}function T(e,t){if(t){delete S[e.$id];if(m){jQuery.sap.log.info("Promise "+e.$id+" caught",Object.keys(S),d)}return}e.$id=$++;e.$error=new Error;S[e.$id]=e;if(m){jQuery.sap.log.info("Promise "+e.$id+" rejected with "+e.getResult(),Object.keys(S),d)}}function j(e,t){var r,i,a,s;t=t||{};r=t.after||function(){};i=t.afterEach||function(){};a=t.before||function(){};s=t.beforeEach||function(){};t.after=function(e){if(window.blanket&&!w&&!this.__ignoreIsolatedCoverage__&&n>=100){v(this,e)}return r.apply(this,arguments)};t.afterEach=function(e){var t=E.bind(null,e.ok.bind(e,false));function n(e){t();throw e}function r(e){if(e&&typeof e.then==="function"){return e.then(r,n)}t();return e}try{return r(i.apply(this,arguments))}catch(e){n(e)}};t.before=function(e){var t;this.$currentFileName=jQuery.sap.getResourceName(e.test.module.name);t=window.blanket&&_$blanket[this.$currentFileName];if(t){this.$oldHits=t.slice();if(t.branchTracking){this.$oldBranchTracking=JSON.parse(JSON.stringify(t.branchTracking,["falsy","truthy"]))}}return a.apply(this,arguments)};t.beforeEach=function(e){E();return s.apply(this,arguments)};y(e,t)}if(QUnit.module!==j){y=QUnit.module.bind(QUnit);QUnit.module=j;sap.ui.require(["sap/base/Log","sap/base/util/UriParameters","sap/ui/base/SyncPromise"],function(e,t,n){m=e.isLoggable(e.Level.INFO,d);w=new t(window.location.href).get("testId");n.listener=T});QUnit.begin(function(){var e,t;jQuery("#qunit-modulefilter-dropdown-list").css("max-height","none");jQuery("#qunit-modulefilter-dropdown").click(function(e){if(e.target.tagName==="LABEL"){setTimeout(function(){jQuery("#qunit-modulefilter-actions").children().first().click()})}});if(window.blanket){for(e in _$blanket){t=_$blanket[e];k[e]=t.slice()}}})}})();