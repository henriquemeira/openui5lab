sap.ui.define(["jquery.sap.global","sap/ui/core/Fragment","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/Popover","sap/m/Button","sap/m/MessageToast","co/h2a/sigpro/ui/controller/BaseController"],function(e,t,o,a,i,n,s,r){"use strict";var l=r.extend("co.h2a.sigpro.ui.controller.ToolPage",{onInit:function(){this.onPressFaturamento.bind(this);this.model.setData(this.data);this.getView().setModel(this.model);this._setToggleButtonTooltip(!sap.ui.Device.system.desktop);this._oContactModel=new a("model/contatos.json");this.getView().setModel(this._oContactModel,"contactModel");this._oCepModel=new a("https://viacep.com.br/ws/01001000/json/");this.getView().setModel(this._oCepModel,"cepModel");this._oCepViewModel=new a({searchTerm:"",busy:false});this.getView().setModel(this._oCepViewModel,"cepViewModel");this._oFaturamentoModel=new a("model/faturamento.json");this.getView().setModel(this._oFaturamentoModel,"faturamentoModel")},model:new a,data:{navigation:[{title:"Operação",icon:"sap-icon://bbyd-active-sales",key:"pageOperacao"},{title:"Faturamento",icon:"sap-icon://sales-document",key:"pageFaturamento"},{title:"Contatos",icon:"sap-icon://contacts",key:"pageContatos"},{title:"CEP",icon:"sap-icon://letter",key:"pageCep"}],fixedNavigation_SUSPENSO:[{title:"Fixed Item 1",icon:"sap-icon://employee"},{title:"Fixed Item 2",icon:"sap-icon://building"},{title:"Fixed Item 3",icon:"sap-icon://card"}],headerItems:[{text:"File"},{text:"Edit"},{text:"View"},{text:"Settings"},{text:"Help"}]},onItemSelect:function(e){var t=e.getParameter("item");var o=this.getView().getId();sap.ui.getCore().byId(o+"--pageContainer").to(o+"--"+t.getKey())},handleUserNamePress:function(e){var t=new i({showHeader:false,placement:sap.m.PlacementType.Bottom,content:[new n({text:"Feedback",type:sap.m.ButtonType.Transparent}),new n({text:"Help",type:sap.m.ButtonType.Transparent}),new n({text:"Logout",type:sap.m.ButtonType.Transparent})]}).addStyleClass("sapMOTAPopover sapTntToolHeaderPopover");t.openBy(e.getSource())},onSideNavButtonPress:function(){var e=this.getView().getId();var t=sap.ui.getCore().byId(e+"--toolPage");var o=t.getSideExpanded();this._setToggleButtonTooltip(o);t.setSideExpanded(!t.getSideExpanded())},_setToggleButtonTooltip:function(e){var t=this.byId("sideNavigationToggleButton");if(e){t.setTooltip("Large Size Navigation")}else{t.setTooltip("Small Size Navigation")}},onCepSearch:function(e){var t=this.getView().getModel("cepViewModel").getProperty("/searchTerm");var o=`https://viacep.com.br/ws/${t}/json/`;this.getView().getModel("cepViewModel").setProperty("/busy",true);function a(e){this.getView().getModel("cepViewModel").setProperty("/busy",false);if(!e.getParameters().success||this._oCepModel.getProperty("/erro")){this._oCepModel.setProperty("/",{});s.show("CEP não encontrado ou inválido")}}this._oCepModel.attachRequestCompleted(a,this);this._oCepModel.loadData(o)},onPressFaturamento:function(e){var t=e.getParameter("row");var o=e.getParameter("item");var a=this.getView().getModel("faturamentoModel");var i=a.getProperty("cliente",t.getBindingContext("faturamentoModel"));var n=a.getProperty("servico",t.getBindingContext("faturamentoModel"));var r=a.getProperty("contrato",t.getBindingContext("faturamentoModel"));s.show("Ação: "+(o.getText()||o.getType())+"\nCliente: "+i+"\nServiço: "+n+"\nContrato: "+r);this._onItemFaturamentoSelect(e)},_onItemFaturamentoSelect:function(e){var t=e.getParameter("item");var o=this.getView().getId();this._onGoToProductTable(e)}});return l});